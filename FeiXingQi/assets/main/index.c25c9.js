System.register("chunks:///_virtual/ChessboardConfigUtils.ts",["cc","./ChessboardGenerator.ts"],(function(r){var o,e;return{setters:[function(r){o=r.cclegacy},function(r){e=r.ChessboardGenerator}],execute:function(){o._RF.push({},"ab9a7LVw3xFaLb3k0xGZyiH","ChessboardConfigUtils",void 0);r("ChessboardConfigUtils",function(){function r(){}return r.validatePathContinuity=function(r){var o=[],n=e.generateChessboard(r);n.sort((function(r,o){return r.number-o.number})),console.log("=== 路径连续性检查 ===");for(var s=0;s<n.length-1;s++){var t=n[s],i=n[s+1],a=Math.abs(i.gridPos.row-t.gridPos.row)+Math.abs(i.gridPos.col-t.gridPos.col);console.log(t.number+"("+t.gridPos.row+","+t.gridPos.col+") -> "+i.number+"("+i.gridPos.row+","+i.gridPos.col+") 距离:"+a),1!==a&&o.push("格子"+t.number+"到"+i.number+"不相邻，距离为"+a)}return console.log("====================="),{valid:0===o.length,errors:o}},r.getCellPositions=function(r){var o=e.generateChessboard(r),n=new Map;return o.forEach((function(r){n.set(r.number,r.gridPos)})),n},r}());o._RF.pop()}}}));

System.register("chunks:///_virtual/ChessboardExamples.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ChessboardTypes.ts"],(function(e){var t,n,s,r,i;return{setters:[function(e){t=e.createForOfIteratorHelperLoose},function(e){n=e.cclegacy},function(e){s=e.Direction,r=e.CellState,i=e.SpecialCellId}],execute:function(){n._RF.push({},"f2cb1btQp1L1q+cRMLKy2/B","ChessboardExamples",void 0);e("DefaultChessboardConfig",{size:{rows:9,cols:6},cellSpacing:{cellWidth:104,cellHeight:104,spacing:10},startPosition:{row:0,col:5,style:2},pathSegments:[{direction:s.左,count:5,style:[1,0]},{direction:s.下,count:8,style:[3,4]},{direction:s.右,count:5,style:[5,6]},{direction:s.上,count:6,style:[3,7]},{direction:s.左,count:3,style:[3,8]},{direction:s.下,count:4,style:[3,3]},{direction:s.右,count:1,style:[3,9]}],iconIndices:{start:r.起点,end:r.终点},specialCells:[{number:10,iconIndex:1,specialId:i.QUESTION},{number:25,iconIndex:1,specialId:i.QUESTION},{number:13,iconIndex:6,specialId:i.DICE_PLUS_ONE},{number:16,iconIndex:6,specialId:i.DICE_PLUS_ONE},{number:15,iconIndex:2,specialId:i.SWAP},{number:21,iconIndex:2,specialId:i.SWAP},{number:18,iconIndex:5,specialId:i.PAUSE},{number:27,iconIndex:5,specialId:i.PAUSE},{number:4,iconIndex:6,specialId:i.DICE_PLUS_ONE},{number:5,iconIndex:2,specialId:i.SWAP},{number:6,iconIndex:1,specialId:i.QUESTION},{number:7,iconIndex:5,specialId:i.PAUSE}]}),e("ChessboardConfigUtils",function(){function e(){}return e.validateConfig=function(e){var n=[];if((e.size.rows<=0||e.size.cols<=0)&&n.push("棋盘尺寸必须大于0"),e.pathSegments){if(0===e.pathSegments.length&&n.push("至少需要一个路径段"),e.startPosition){var s=e.startPosition,r=s.row,i=s.col;(r<0||r>=e.size.rows||i<0||i>=e.size.cols)&&n.push("起点位置超出边界: ("+r+", "+i+")")}else n.push("使用路径段方式时必须指定起点位置");e.pathSegments.forEach((function(e,t){e.count<=0&&n.push("路径段 "+t+" 的格子数量必须大于0")}))}if(e.segments){0===e.segments.length&&n.push("至少需要一个线段");for(var o,c=new Set,a=t(e.segments);!(o=a()).done;){var u=o.value;u.startNumber>u.endNumber&&n.push("线段编号错误: "+u.startNumber+" > "+u.endNumber);for(var l=u.startNumber;l<=u.endNumber;l++)c.has(l)&&n.push("格子编号重复: "+l),c.add(l);var d=u.startPos,m=d.row,p=d.col;(m<0||m>=e.size.rows||p<0||p>=e.size.cols)&&n.push("起始位置超出边界: ("+m+", "+p+")")}}return{valid:0===n.length,errors:n}},e.getTotalCells=function(e){return e.pathSegments?e.pathSegments.reduce((function(e,t){return e+t.count}),0):e.segments?e.segments.reduce((function(e,t){return e+(t.endNumber-t.startNumber+1)}),0):0},e.getStyleUsage=function(e){var t={};if(e.pathSegments&&e.startPosition){var n=e.startPosition.style||0;t[n]=(t[n]||0)+1,e.pathSegments.forEach((function(e){if(e.style){var n=e.style,s=n[0],r=n[1],i=Math.max(0,e.count-1);t[s]=(t[s]||0)+i,t[r]=(t[r]||0)+1}}))}return t},e.getNumberRange=function(e){if(e.pathSegments)return{min:1,max:this.getTotalCells(e)};if(e.segments){var t=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER;return e.segments.forEach((function(e){t=Math.min(t,e.startNumber),n=Math.max(n,e.endNumber)})),{min:t,max:n}}return{min:1,max:1}},e}());n._RF.pop()}}}));

System.register("chunks:///_virtual/ChessboardGenerator.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ChessboardTypes.ts"],(function(e){var o,t,n,r,s;return{setters:[function(e){o=e.extends,t=e.createForOfIteratorHelperLoose},function(e){n=e.cclegacy},function(e){r=e.CellState,s=e.Direction}],execute:function(){n._RF.push({},"fc79aASsyNKqpm/DUmnAbK/","ChessboardGenerator",void 0);e("ChessboardGenerator",function(){function e(){}return e.generateChessboard=function(e){var o=[],t=this.generateFromPathSegments(e.startPosition,e.pathSegments);return o.push.apply(o,t),this.applySpecialCells(o,e),this.applyStartEndIcons(o,e),console.log("=== 棋盘生成调试信息 ==="),o.forEach((function(e){var o,t;console.log("格子"+e.number+": 位置("+e.gridPos.row+", "+e.gridPos.col+"), 样式"+e.style+", 状态"+e.state+", 图标"+(null!=(o=e.iconIndex)?o:-1)+", 特殊"+(null!=(t=e.specialId)?t:""))})),console.log("========================"),o},e.generateFromPathSegments=function(e,t){var n=[],l=o({},e),c=1,i=t.reduce((function(e,o){return e+o.count}),0)+1;console.log("总格子数: "+i+" (包括起始点)"),console.log("起点: ("+l.row+", "+l.col+"), 起点样式: "+e.style),n.push({number:c,state:r.起点,gridPos:o({},l),style:e.style||0}),console.log("格子"+c+": 起始点, 位置("+l.row+", "+l.col+"), 样式"+(e.style||0)+", 状态"+r[r.起点]),c++;for(var a=0;a<t.length;a++){var u,d,p=t[a],f=this.getDirectionVector(p.direction),g=a===t.length-1;console.log("处理第"+(a+1)+"段: 方向"+s[p.direction]+", 格子数"+p.count+", 样式["+(null==(u=p.style)?void 0:u[0])+", "+(null==(d=p.style)?void 0:d[1])+"]");for(var v=0;v<p.count;v++){l.row+=f.row,l.col+=f.col;var h=r.常态,y=0;if(c===i)h=r.终点,y=p.style?p.style[1]:0;else y=v===p.count-1&&!g?p.style?p.style[1]:0:p.style?p.style[0]:0;n.push({number:c,state:h,gridPos:o({},l),style:y}),console.log("格子"+c+": 段"+(a+1)+"的第"+(v+1)+"个, 位置("+l.row+", "+l.col+"), 样式"+y+", 状态"+r[h]),c++}}return n},e.applySpecialCells=function(e,o){if(o.specialCells&&0!==o.specialCells.length){for(var n,r={},s=t(o.specialCells);!(n=s()).done;){var l=n.value;r[l.number]={iconIndex:l.iconIndex,specialId:l.specialId}}for(var c,i=t(e);!(c=i()).done;){var a=c.value,u=r[a.number];u&&(a.iconIndex=u.iconIndex,a.isSpecial=!0,a.specialId=u.specialId)}}},e.applyStartEndIcons=function(e,o){for(var n,s,l,c=null==(n=o.iconIndices)?void 0:n.start,i=null==(s=o.iconIndices)?void 0:s.end,a=t(e);!(l=a()).done;){var u=l.value;u.state===r.起点&&void 0!==c&&(u.iconIndex=c),u.state===r.终点&&void 0!==i&&(u.iconIndex=i)}},e.generateSegmentCells=function(e){for(var o=[],t=e.startNumber,n=e.endNumber,s=e.startPos,l=e.direction,c=e.specialStates,i=this.getDirectionVector(l),a=function(){var e=t+u,n={row:s.row+i.row*u,col:s.col+i.col*u},l=r.常态;if(c){var a=c.find((function(o){return o.number===e}));a&&(l=a.state)}o.push({number:e,state:l,gridPos:n,style:0})},u=0;u<=n-t;u++)a();return o},e.getDirectionVector=function(e){switch(e){case s.右:return{row:0,col:1};case s.下:return{row:1,col:0};case s.左:return{row:0,col:-1};case s.上:return{row:-1,col:0};default:return{row:0,col:0}}},e.createGridMap=function(e){var o=new Map;return e.forEach((function(e){var t=e.gridPos.row+"_"+e.gridPos.col;o.set(t,e)})),o},e.getGridKey=function(e,o){return e+"_"+o},e}());n._RF.pop()}}}));

System.register("chunks:///_virtual/ChessboardTypes.ts",["cc"],(function(e){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"c502eOJ4NVJBq3DTSEBxLXG","ChessboardTypes",void 0);e("CellState",function(e){return e[e["常态"]=0]="常态",e[e["问号"]=1]="问号",e[e["交换"]=2]="交换",e[e["起点"]=3]="起点",e[e["终点"]=4]="终点",e[e["锁"]=5]="锁",e[e["骰子"]=6]="骰子",e}({})),e("Direction",function(e){return e[e["右"]=0]="右",e[e["下"]=1]="下",e[e["左"]=2]="左",e[e["上"]=3]="上",e}({})),e("SpecialCellId",function(e){return e.QUESTION="QUESTION",e.DICE_PLUS_ONE="DICE_PLUS_ONE",e.SWAP="SWAP",e.PAUSE="PAUSE",e}({}));t._RF.pop()}}}));

System.register("chunks:///_virtual/CommonExport.ts",["cc","./drongo-cc.mjs","./fairygui.mjs","./drongo-gui.mjs"],(function(o){var n;return{setters:[function(c){n=c.cclegacy,o("cc",c)},function(n){o("drongoCC",n)},function(n){o("fgui",n)},function(n){o("drongoGui",n)}],execute:function(){n._RF.push({},"2a54bPglDFEaKMITwv2aDNG","CommonExport",void 0),n._RF.pop()}}}));

System.register("chunks:///_virtual/ConfigBase.ts",["cc"],(function(t){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"6aa16Nf6rJP87ezxWaLdhoO","ConfigBase",void 0);t("default",function(){function t(){}return t.prototype.init=function(t){var e=this;t&&"object"==typeof t&&Object.keys(t).forEach((function(n){e.hasOwnProperty(n)&&(e[n]=t[n])}))},t}());e._RF.pop()}}}));

System.register("chunks:///_virtual/ConfigMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./drongo-cc.mjs"],(function(n){var e,t,r,s,i,o,a,u,c;return{setters:[function(n){e=n.inheritsLoose,t=n.createForOfIteratorHelperLoose,r=n.asyncToGenerator,s=n.regeneratorRuntime},function(n){i=n.cclegacy,o=n.JsonAsset},function(n){a=n.autoBindToWindow,u=n.instance_base,c=n.asset}],execute:function(){var f;i._RF.push({},"ab49fwHf11ArqXDrPGKAbkd","ConfigMgr",void 0);var g=a(f=function(n){function i(){for(var e,t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return(e=n.call.apply(n,[this].concat(r))||this).configs=new Map,e.configAssets=new Map,e}e(i,n);var a=i.prototype;return a.loadConfig=function(){var n=r(s().mark((function n(e){var t,r;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=e.name,!this.configs.has(t)){n.next=3;break}return n.abrupt("return");case 3:return n.next=5,c.get("Config/"+t,o,null);case 5:r=n.sent,this.initConfig(e,r);case 7:case"end":return n.stop()}}),n,this)})));return function(e){return n.apply(this,arguments)}}(),a.initConfig=function(n,e){var t=n.name,r=new Map;for(var s in e.json){var i=e.json[s],o=new n;o.init(i),r.set(parseInt(s),o)}e.decRef(),this.configs.set(t,r)},a.initConfigs=function(){var n=r(s().mark((function n(e){var r,i,a,u,f;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,c.get_dir(e,o,null);case 2:for(r=n.sent,i=t(r);!(a=i()).done;)u=a.value,f=u.name.replace(".json",""),this.configAssets.set(f,u);case 4:case"end":return n.stop()}}),n,this)})));return function(e){return n.apply(this,arguments)}}(),a.getConfig=function(n,e){var t=n.name,r=this.configAssets.get(t);r&&(this.initConfig(n,r),this.configAssets.delete(t));var s=this.configs.get(t);return s?s.get(e):null},a.getAllConfigs=function(n){var e=n.name,t=this.configAssets.get(e);t&&(this.initConfig(n,t),this.configAssets.delete(e));var r=this.configs.get(e);return r||null},a.queryOne=function(n,e){for(var r,s=this.getAllConfigs(n),i=t(s.values());!(r=i()).done;){var o=r.value;if(e(o))return o}return null},a.queryAll=function(n,e){for(var r,s=this.getAllConfigs(n),i=[],o=t(s.values());!(r=o()).done;){var a=r.value;e(a)&&i.push(a)}return i},i}(u))||f;n("configMgr",g.instance());i._RF.pop()}}}));

System.register("chunks:///_virtual/Game_Button1.ts",["./rollupPluginModLoBabelHelpers.js","cc","./fairygui.mjs","./drongo-gui.mjs"],(function(t){var n,e,o,r,c;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy},function(t){o=t.UIPackage,r=t.GButton},function(t){c=t.vm}],execute:function(){var u,i;e._RF.push({},"f65f78RrABD0JadMIaST6m6","Game_Button1",void 0);t("default",c(((i=function(t){function e(){for(var n,e=arguments.length,o=new Array(e),r=0;r<e;r++)o[r]=arguments[r];return(n=t.call.apply(t,[this].concat(o))||this).m_c1=void 0,n}return n(e,t),e.createInstance=function(){return o.createObject("Game","Button1")},e.prototype.onConstruct=function(){this.m_c1=this.getController("c1")},e}(r)).URL="ui://bpp6st2qme221r",i.Dependencies=["Game"],u=i))||u);e._RF.pop()}}}));

System.register("chunks:///_virtual/Game_Button7.ts",["./rollupPluginModLoBabelHelpers.js","cc","./fairygui.mjs","./drongo-gui.mjs"],(function(t){var n,e,o,u,i;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy},function(t){o=t.UIPackage,u=t.GButton},function(t){i=t.vm}],execute:function(){var r,c;e._RF.push({},"3ee9fJEXGhAVIV/H85MpV3U","Game_Button7",void 0);t("default",i(((c=function(t){function e(){for(var n,e=arguments.length,o=new Array(e),u=0;u<e;u++)o[u]=arguments[u];return(n=t.call.apply(t,[this].concat(o))||this).m_t0=void 0,n}return n(e,t),e.createInstance=function(){return o.createObject("Game","Button7")},e.prototype.onConstruct=function(){this.m_t0=this.getTransition("t0")},e}(u)).URL="ui://bpp6st2qdosa3y",c.Dependencies=["Game"],r=c))||r);e._RF.pop()}}}));

System.register("chunks:///_virtual/Game_Button9.ts",["./rollupPluginModLoBabelHelpers.js","cc","./fairygui.mjs","./drongo-gui.mjs"],(function(t){var n,e,o,u,i;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy},function(t){o=t.UIPackage,u=t.GButton},function(t){i=t.vm}],execute:function(){var r,c;e._RF.push({},"19f629ap3VCMqB/IBtzO2LW","Game_Button9",void 0);t("default",i(((c=function(t){function e(){for(var n,e=arguments.length,o=new Array(e),u=0;u<e;u++)o[u]=arguments[u];return(n=t.call.apply(t,[this].concat(o))||this).m_t0=void 0,n}return n(e,t),e.createInstance=function(){return o.createObject("Game","Button9")},e.prototype.onConstruct=function(){this.m_t0=this.getTransition("t0")},e}(u)).URL="ui://bpp6st2qdosa4t",c.Dependencies=["Game"],r=c))||r);e._RF.pop()}}}));

System.register("chunks:///_virtual/Game_Cell_Logic.ts",["./rollupPluginModLoBabelHelpers.js","cc","./drongo-gui.mjs","./Game_Cell.ts","./GameTypes.ts"],(function(t){var e,c,s,n,i,o,u;return{setters:[function(t){e=t.inheritsLoose},function(t){c=t.cclegacy,s=t.Label},function(t){n=t.addLogic,i=t.GUILogicBase},function(t){o=t.default},function(t){u=t.PlayerType}],execute:function(){var a;c._RF.push({},"5ce4dVQY9tHfYDskeYeX9x6","Game_Cell_Logic",void 0);t("default",n(o)(a=function(t){function c(){for(var e,c=arguments.length,s=new Array(c),n=0;n<c;n++)s[n]=arguments[n];return(e=t.call.apply(t,[this].concat(s))||this).occupants=[],e}e(c,t);var n=c.prototype;return n.onLoad=function(){this.updateDisplay(),this.UI.m_num._label.cacheMode=s.CacheMode.BITMAP},n.addPiece=function(t){this.occupants.includes(t)||(this.occupants.push(t),this.updateDisplay(),this._log.log("格子"+this.UI.m_num.text+": 添加"+u[t]+"棋子"))},n.removePiece=function(t){var e=this.occupants.indexOf(t);e>-1&&(this.occupants.splice(e,1),this.updateDisplay(),this._log.log("格子"+this.UI.m_num.text+": 移除"+u[t]+"棋子"))},n.hasPiece=function(t){return this.occupants.includes(t)},n.getOccupants=function(){return[].concat(this.occupants)},n.clearAllPieces=function(){this.occupants=[],this.updateDisplay(),this._log.log("格子"+this.UI.m_num.text+": 清空所有棋子")},n.updateDisplay=function(){if(0===this.occupants.length)this.UI.m_c3.selectedIndex=0;else if(1===this.occupants.length){var t=this.occupants[0];this.UI.m_c3.selectedIndex=t===u.P1?1:2}else{var e=this.occupants[this.occupants.length-1];this.UI.m_c3.selectedIndex=e===u.P1?1:2}this._log.log("格子"+this.UI.m_num.text+": m_c3.selectedIndex = "+this.UI.m_c3.selectedIndex+", 棋子: ["+this.occupants.map((function(t){return u[t]})).join(", ")+"]")},c}(i))||a);c._RF.pop()}}}));

System.register("chunks:///_virtual/Game_Cell.ts",["./rollupPluginModLoBabelHelpers.js","cc","./fairygui.mjs","./drongo-gui.mjs"],(function(t){var e,n,i,o,c;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy},function(t){i=t.UIPackage,o=t.GComponent},function(t){c=t.vm}],execute:function(){var r,s;n._RF.push({},"4fa55F1aLhJromYj4fzaKF7","Game_Cell",void 0);t("default",c(((s=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).m_c1=void 0,e.m_c2=void 0,e.m_c3=void 0,e.m_c4=void 0,e.m_num=void 0,e.m_t0=void 0,e}return e(n,t),n.createInstance=function(){return i.createObject("Game","Cell")},n.prototype.onConstruct=function(){this.m_c1=this.getController("c1"),this.m_c2=this.getController("c2"),this.m_c3=this.getController("c3"),this.m_c4=this.getController("c4"),this.m_num=this.getChild("num"),this.m_t0=this.getTransition("t0")},n}(o)).URL="ui://bpp6st2qme221k",s.Dependencies=["Game"],r=s))||r);n._RF.pop()}}}));

System.register("chunks:///_virtual/Game_Dialog_Logic.ts",["./rollupPluginModLoBabelHelpers.js","cc","./drongo-gui.mjs","./Game_Dialog.ts","./TaskDialogWindow.ts","./GameEvents.ts"],(function(t){var e,n,r,i,s,a,o,c,l;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy},function(t){r=t.UILayer,i=t.addLogic,s=t.GUIManager,a=t.GUILogicBase},function(t){o=t.default},function(t){c=t.TaskDialogWindow},function(t){l=t.gameEvent}],execute:function(){var u,h;n._RF.push({},"8600dodVdRI7pCBkpcRo+g5","Game_Dialog_Logic",void 0);t("default",i(o)(((h=function(t){function n(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).currentTask=null,e.currentPlayer=null,e}e(n,t);var r=n.prototype;return r.onLoad=function(){var t=this;this.UI.m_btn.onClick((function(){return t.onCompleteClick()}),this),this.Data&&this.showTask(this.Data)},r.start=function(){this.Data&&this.showTask(this.Data)},r.showTask=function(t){var e;this.currentTask=t,this.currentPlayer=t.player;var n="P1"===(null==(e=this.currentPlayer)?void 0:e.name)?0:1;this.UI.m_c1.selectedIndex=n,this._log.log("设置UI样式 - 使用玩家编号: "+n),this.UI.m_c2.selectedIndex=this.currentPlayer.characterId,this._log.log("设置m_c2控制器 - 角色ID: "+this.currentPlayer.characterId),this.UI.m_content.text=t.content,this._log.log("显示任务对话框完成: ID="+t.id+", 分类="+t.category+" - "+t.content)},r.hideTask=function(){this.currentTask=null,this.currentPlayer=null},r.onCompleteClick=function(){this.currentTask&&999===this.currentTask.id?l.emit(l.key.DialogClosed,{}):this.currentTask&&this.currentPlayer?l.emit(l.key.TaskCompleted,{task:this.currentTask,player:this.currentPlayer}):console.error("普通任务但缺少必要数据:",{hasTask:!!this.currentTask,hasPlayer:!!this.currentPlayer}),s.close(o),this.hideTask()},r.getCurrentTask=function(){return this.currentTask},r.isVisible=function(){return 3===s.getGUIState(o)},n}(a)).uiOptions={layer:r.TIP,modal:!0,windowCls:c},u=h))||u);n._RF.pop()}}}));

System.register("chunks:///_virtual/Game_Dialog.ts",["./rollupPluginModLoBabelHelpers.js","cc","./fairygui.mjs","./drongo-gui.mjs"],(function(t){var e,n,i,o,c;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy},function(t){i=t.UIPackage,o=t.GComponent},function(t){c=t.vm}],execute:function(){var r,s;n._RF.push({},"23a89hJIzhMAbMh1t4GHuo9","Game_Dialog",void 0);t("default",c(((s=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).m_c1=void 0,e.m_c2=void 0,e.m_title=void 0,e.m_content=void 0,e.m_btn=void 0,e}return e(n,t),n.createInstance=function(){return i.createObject("Game","Dialog")},n.prototype.onConstruct=function(){this.m_c1=this.getController("c1"),this.m_c2=this.getController("c2"),this.m_title=this.getChild("title"),this.m_content=this.getChild("content"),this.m_btn=this.getChild("btn")},n}(o)).URL="ui://bpp6st2qme221p",s.Dependencies=["Game"],r=s))||r);n._RF.pop()}}}));

System.register("chunks:///_virtual/Game_DiuTouZi_Logic.ts",["./rollupPluginModLoBabelHelpers.js","cc","./drongo-gui.mjs","./Game_DiuTouZi.ts","./Game_Touzi_Logic.ts","./GameEvents.ts","./fairygui.mjs"],(function(i){var t,o,e,n,c,u,a,s,l,r;return{setters:[function(i){t=i.inheritsLoose},function(i){o=i.cclegacy},function(i){e=i.addLogic,n=i.GUIManager,c=i.GUILogicBase},function(i){u=i.default},function(i){a=i.default},function(i){s=i.gameEvent},function(i){l=i.UIPackage,r=i.GRoot}],execute:function(){var g,f;o._RF.push({},"a398euXiOtFIKdSYZ74Jj0p","Game_DiuTouZi_Logic",void 0);i("default",e(u)(((f=function(i){function o(){for(var t,o=arguments.length,e=new Array(o),n=0;n<o;n++)e[n]=arguments[n];return(t=i.call.apply(i,[this].concat(e))||this).diceLogic=void 0,t}t(o,i);var e=o.prototype;return e.start=function(){this.setupDiceLogic(),this.startDiceAnimation()},e.setupDiceLogic=function(){this.diceLogic=this.UI.m_touzi.Get(a)},e.playDiceSound=function(){try{var i=l.getByName("Game");if(i){var t=i.getItemAssetByName("diutouzi");t&&(r.inst.playOneShotSound(t,.3),this._log.log("播放骰子音效"))}}catch(i){this._log.log("播放骰子音效失败:",i)}},e.startDiceAnimation=function(){var i=this;if(!this.diceLogic)return console.error("骰子逻辑组件未找到"),void this.closeDiceDialog();this._log.log("开始播放骰子动画"),this.playDiceSound(),this.diceLogic.playDiceAnimation((function(t){i._log.log("骰子结果: "+t.value),i.scheduleOnce((function(){s.emit(s.key.DiceRolled,t),i.closeDiceDialog()}),1)}))},e.closeDiceDialog=function(){n.close(u)},e.onDestroy=function(){i.prototype.onDestroy.call(this)},o}(c)).uiOptions={modal:!0},g=f))||g);o._RF.pop()}}}));

System.register("chunks:///_virtual/Game_DiuTouZi.ts",["./rollupPluginModLoBabelHelpers.js","cc","./fairygui.mjs","./drongo-gui.mjs"],(function(t){var n,e,i,o,u;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy},function(t){i=t.UIPackage,o=t.GComponent},function(t){u=t.vm}],execute:function(){var c,r;e._RF.push({},"aa5f4BCnUdK0ZRmw+OT0CMw","Game_DiuTouZi",void 0);t("default",u(((r=function(t){function e(){for(var n,e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return(n=t.call.apply(t,[this].concat(i))||this).m_touzi=void 0,n}return n(e,t),e.createInstance=function(){return i.createObject("Game","DiuTouZi")},e.prototype.onConstruct=function(){this.m_touzi=this.getChild("touzi")},e}(o)).URL="ui://bpp6st2qdosa3u",r.Dependencies=["Game"],c=r))||c);e._RF.pop()}}}));

System.register("chunks:///_virtual/Game_JiaoHuanWeiZi_Logic.ts",["./rollupPluginModLoBabelHelpers.js","cc","./drongo-gui.mjs","./Game_JiaoHuanWeiZi.ts","./GameEvents.ts","./TaskDialogWindow.ts"],(function(t){var e,i,a,n,o,r,s,c,u;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy},function(t){a=t.UILayer,n=t.addLogic,o=t.GUIManager,r=t.GUILogicBase},function(t){s=t.default},function(t){c=t.gameEvent},function(t){u=t.TaskDialogWindow}],execute:function(){var l,d;i._RF.push({},"8db09yImixCWYxwY/PCXpr0","Game_JiaoHuanWeiZi_Logic",void 0);t("default",n(s)(((d=function(t){function i(){return t.apply(this,arguments)||this}e(i,t);var a=i.prototype;return a.onLoad=function(){var t=this;this.UI.m_okBtn.onClick((function(){var e=t.Data,i=null==e?void 0:e.players;Array.isArray(i)&&i.length>=2&&c.emit(c.key.SwapPositionsRequested,{p1:i[0],p2:i[1]}),o.close(s)}),this)},a.start=function(){var t=this.Data;try{var e;if(2===(null==t||null==(e=t.players)?void 0:e.length)){var i=t.players[0],a=t.players[1];"number"==typeof(null==i?void 0:i.characterId)&&(this.UI.m_P1.m_c1.selectedIndex=i.characterId),"number"==typeof(null==a?void 0:a.characterId)&&(this.UI.m_P2.m_c1.selectedIndex=a.characterId)}this.UI.m_t0.play()}catch(t){}},i}(r)).uiOptions={layer:a.TIP,modal:!0,windowCls:u},l=d))||l);i._RF.pop()}}}));

System.register("chunks:///_virtual/Game_JiaoHuanWeiZi.ts",["./rollupPluginModLoBabelHelpers.js","cc","./fairygui.mjs","./drongo-gui.mjs"],(function(t){var i,n,e,o,a;return{setters:[function(t){i=t.inheritsLoose},function(t){n=t.cclegacy},function(t){e=t.UIPackage,o=t.GComponent},function(t){a=t.vm}],execute:function(){var c,r;n._RF.push({},"6d6e3zGJidBWo+QcvCaEyhX","Game_JiaoHuanWeiZi",void 0);t("default",a(((r=function(t){function n(){for(var i,n=arguments.length,e=new Array(n),o=0;o<n;o++)e[o]=arguments[o];return(i=t.call.apply(t,[this].concat(e))||this).m_okBtn=void 0,i.m_P1=void 0,i.m_P2=void 0,i.m_t0=void 0,i}return i(n,t),n.createInstance=function(){return e.createObject("Game","JiaoHuanWeiZi")},n.prototype.onConstruct=function(){this.m_okBtn=this.getChild("okBtn"),this.m_P1=this.getChild("P1"),this.m_P2=this.getChild("P2"),this.m_t0=this.getTransition("t0")},n}(o)).URL="ui://bpp6st2qjh7854",r.Dependencies=["Game"],c=r))||c);n._RF.pop()}}}));

System.register("chunks:///_virtual/Game_JueSeSelect_Logic.ts",["./rollupPluginModLoBabelHelpers.js","cc","./drongo-gui.mjs","./PlayerDataModel.ts","./Game_JueSeSelect.ts"],(function(t){var e,n,r,i,a,c;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy},function(t){r=t.addLogic,i=t.GUILogicBase},function(t){a=t.playerDataModel},function(t){c=t.default}],execute:function(){var u;n._RF.push({},"f92c0GioMlNTLRuNmbu5H7r","Game_JueSeSelect_Logic",void 0);t("default",r(c)(u=function(t){function n(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).currentIndex=0,e.maxCharacterCount=2,e.playerNumber=1,e}e(n,t);var r=n.prototype;return r.onLoad=function(){this.setupEventListeners()},r.initializeForPlayer=function(t){this.playerNumber=t,this.initializeCharacterSelection()},r.getCurrentIndex=function(){return this.currentIndex},r.initializeCharacterSelection=function(){this.maxCharacterCount=this.UI.m_c1.pageCount,this.currentIndex=a.getPlayerCharacterId(this.playerNumber),(this.currentIndex<0||this.currentIndex>=this.maxCharacterCount)&&(this.currentIndex=0),this.updateCharacterDisplay()},r.setupEventListeners=function(){this.UI.m_left.onClick(this.onLeftClick,this),this.UI.m_right.onClick(this.onRightClick,this)},r.onLeftClick=function(){this.maxCharacterCount<=1||(this.currentIndex=(this.currentIndex-1+this.maxCharacterCount)%this.maxCharacterCount,this.updateCharacterDisplay())},r.onRightClick=function(){this.maxCharacterCount<=1||(this.currentIndex=(this.currentIndex+1)%this.maxCharacterCount,this.updateCharacterDisplay())},r.updateCharacterDisplay=function(){0!==this.maxCharacterCount&&(this.UI.m_c1.selectedIndex=this.currentIndex,this.updateArrowButtons(),this._log.log("P"+this.playerNumber+"当前预览角色ID: "+this.currentIndex))},r.updateArrowButtons=function(){this.UI.m_left.enabled=!0,this.UI.m_right.enabled=!0},n}(i))||u);n._RF.pop()}}}));

System.register("chunks:///_virtual/Game_JueSeSelect.ts",["./rollupPluginModLoBabelHelpers.js","cc","./fairygui.mjs","./drongo-gui.mjs"],(function(e){var t,n,i,c,r;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy},function(e){i=e.UIPackage,c=e.GComponent},function(e){r=e.vm}],execute:function(){var o,u;n._RF.push({},"82cbaw2JcZK7Zr9dpHeExbn","Game_JueSeSelect",void 0);e("default",r(((u=function(e){function n(){for(var t,n=arguments.length,i=new Array(n),c=0;c<n;c++)i[c]=arguments[c];return(t=e.call.apply(e,[this].concat(i))||this).m_c1=void 0,t.m_right=void 0,t.m_left=void 0,t}return t(n,e),n.createInstance=function(){return i.createObject("Game","JueSeSelect")},n.prototype.onConstruct=function(){this.m_c1=this.getController("c1"),this.m_right=this.getChild("right"),this.m_left=this.getChild("left")},n}(c)).URL="ui://bpp6st2qdosa2r",u.Dependencies=["Game"],o=u))||o);n._RF.pop()}}}));

System.register("chunks:///_virtual/Game_List_Logic.ts",["./rollupPluginModLoBabelHelpers.js","cc","./drongo-gui.mjs","./Game_List.ts","./Game_Cell.ts","./Game_Cell_Logic.ts","./Game_Peaple.ts","./Game_Dialog.ts","./Game_Succ.ts","./ChessboardTypes.ts","./ChessboardGenerator.ts","./ChessboardExamples.ts","./GameTypes.ts","./TaskManager.ts","./GameEvents.ts","./fairygui.mjs","./Game_JiaoHuanWeiZi.ts","./Game_ZhanTingHuiHe.ts","./Game_WenHao.ts","./Game_LukyTouZi.ts"],(function(e){var t,n,a,i,r,s,o,l,c,u,h,y,p,d,g,f,m,P,v,_,C,x,S,b,I,G,k,E;return{setters:[function(e){t=e.inheritsLoose,n=e.asyncToGenerator,a=e.regeneratorRuntime},function(e){i=e.cclegacy,r=e.tween},function(e){s=e.GUIManager,o=e.addLogic,l=e.GUILogicBase},function(e){c=e.default},function(e){u=e.default},function(e){h=e.default},function(e){y=e.default},function(e){p=e.default},function(e){d=e.default},function(e){g=e.SpecialCellId},function(e){f=e.ChessboardGenerator},function(e){m=e.DefaultChessboardConfig},function(e){P=e.PlayerType,v=e.GameState,_=e.DefaultGameConfig},function(e){C=e.taskManager},function(e){x=e.gameEvent},function(e){S=e.UIPackage,b=e.GRoot},function(e){I=e.default},function(e){G=e.default},function(e){k=e.default},function(e){E=e.default}],execute:function(){var D;i._RF.push({},"6155ad8NiRPCZe4l7KHhner","Game_List_Logic",void 0);e("default",o(c)(D=function(e){function i(){for(var t,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(t=e.call.apply(e,[this].concat(a))||this).chessboardData=[],t.gridMap=new Map,t.cellComponents=new Map,t.cellLogics=new Map,t.players=[],t.playerPieces=new Map,t.currentPlayer=0,t.hasExtraTurn=!1,t.gameState=v.准备中,t.diceLogic=void 0,t.pausedPlayers=new Set,t}t(i,e);var o=i.prototype;return o.playSwapAnimation=function(e,t){var n=this;if(e&&t){var a=this.playerPieces.get(e.type),i=this.playerPieces.get(t.type),s=this.cellComponents.get(e.currentPosition),o=this.cellComponents.get(t.currentPosition);if(a&&i&&s&&o){try{s.m_c4.selectedIndex=1}catch(e){}try{o.m_c4.selectedIndex=1}catch(e){}var l=0,c=function(){if(!(++l<2)){var c=0,u=function(){var l,u,h,y;if(!(++c<2)){var p=e.currentPosition,d=t.currentPosition,g=e.currentPosition;e.currentPosition=t.currentPosition,t.currentPosition=g;var f=n.cellComponents.get(e.currentPosition),m=n.cellComponents.get(t.currentPosition);f&&a.setPosition(f.x,f.y+15),m&&i.setPosition(m.x,m.y+15);try{s.m_c4.selectedIndex=0}catch(e){}try{o.m_c4.selectedIndex=0}catch(e){}var P=0,v=function(){++P>=2&&n.nextPlayer()};r(a).to(.25,{scaleY:1}).call(v).start(),r(i).to(.25,{scaleY:1}).call(v).start(),null==(l=n.cellLogics.get(p))||l.removePiece(e.type),null==(u=n.cellLogics.get(d))||u.removePiece(t.type),null==(h=n.cellLogics.get(e.currentPosition))||h.addPiece(e.type),null==(y=n.cellLogics.get(t.currentPosition))||y.addPiece(t.type),n.updatePlayersZOrder()}};r(a).to(.25,{scaleY:0}).call(u).start(),r(i).to(.25,{scaleY:0}).call(u).start()}},u=function(e){if(null!=e&&e.m_t0&&"function"==typeof e.m_t0.play)try{e.m_t0.play((function(){return c()}),1,0)}catch(e){c()}else c()};u(s),u(o)}}},o.onLoad=function(){this.setupGameEvents()},o.setupGameEvents=function(){var e=this;x.on(x.key.TaskCompleted,(function(t){e.nextPlayer()}),this),x.on(x.key.SwapPositionsRequested,(function(t){var n=t.p1,a=t.p2;e.playSwapAnimation(n,a)}),this),x.on(x.key.LuckyExtraTurn,(function(t){var n=t.player,a=e.players[e.currentPlayer];a&&n&&a.type===n.type&&(e.hasExtraTurn=!0,e.nextPlayer())}),this),x.on(x.key.QuestionPopupContinue,(function(t){t.player;e.nextPlayer()}),this),x.on(x.key.PauseTurnRequested,(function(t){var n=t.player;if(n){e.pausedPlayers.add(n.type);var a=e.playerPieces.get(n.type);if(a&&a.m_c3&&(a.m_c3.selectedIndex=1),a&&a.m_t0&&"function"==typeof a.m_t0.play)try{a.m_t0.play((function(){e.nextPlayer()}),1,0)}catch(t){e.nextPlayer()}else e.nextPlayer()}}),this),x.on(x.key.NextPlayerTurn,(function(t){e._log.log("=== 收到NextPlayerTurn事件 ==="),e._log.log("事件通知: 轮到 "+t.name+" 了")}),this),x.on(x.key.GameEnded,(function(t){e._log.log("=== 收到GameEnded事件 ==="),e._log.log("事件通知: 游戏结束，获胜者是 "+t.name)}),this),x.on(x.key.DialogClosed,(function(t){e._log.log("=== 收到DialogClosed事件 ==="),e._log.log("当前游戏状态: "+e.gameState)}),this)},o.generateChessboard=function(e){this.clearChessboard(),this.chessboardData=f.generateChessboard(e),this.gridMap=f.createGridMap(this.chessboardData),this.createChessboardUI(),this._log.log("棋盘生成完成，共",this.chessboardData.length,"个格子")},o.createChessboardUI=function(){var e=this;this.clearChessboardComponents(),this.chessboardData.forEach((function(t){var n=e.createCellComponent(t);e.cellComponents.set(t.number,n),e.UI.addChild(n);var a=n.Get(h);a&&e.cellLogics.set(t.number,a)}))},o.createCellComponent=function(e){var t=this,n=u.createInstance();return n.m_num.text=e.number.toString(),n.m_c1.selectedIndex=e.style,"number"==typeof e.iconIndex?n.m_c2.selectedIndex=e.iconIndex:n.m_c2.selectedIndex=e.state,this.setCellPosition(n,e),n.onClick((function(){return t.onCellClick(e.number)}),this),n},o.setCellPosition=function(e,t){var n,a,i,r=(null==(n=m.cellSpacing)?void 0:n.cellWidth)||60,s=(null==(a=m.cellSpacing)?void 0:a.cellHeight)||60,o=(null==(i=m.cellSpacing)?void 0:i.spacing)||5,l=t.gridPos.col*(r+o)+r/2,c=t.gridPos.row*(s+o)+s/2;e.setPosition(l,c)},o.clearChessboardComponents=function(){this.cellComponents.forEach((function(e){e.parent&&e.parent.removeChild(e)})),this.cellComponents.clear(),this.cellLogics.clear()},o.initializePlayers=function(e,t){var n=this;void 0===e&&(e=0),void 0===t&&(t=1),this.clearPlayers(),this.players=[{type:P.P1,currentPosition:1,isFinished:!1,name:"P1",characterId:e},{type:P.P2,currentPosition:1,isFinished:!1,name:"P2",characterId:t}],this.createPlayerPieces(),this.players.forEach((function(e){var t=n.cellLogics.get(e.currentPosition);t&&t.addPiece(e.type)})),this.updatePlayersZOrder(),this._log.log("玩家初始化完成","P1角色ID: "+e+", P2角色ID: "+t)},o.createPlayerPieces=function(){var e=this;this.players.forEach((function(t,n){var a=y.createInstance();a.m_c2.selectedIndex=n+1,a.m_c1.selectedIndex=t.characterId,e._log.log("创建"+t.name+"棋子 - m_c1: "+n+", m_c2: "+t.characterId),e.playerPieces.set(t.type,a),e.UI.addChild(a)})),this.updatePlayerPositions()},o.updatePlayerPositions=function(){var e=this;this.players.forEach((function(t){var n=e.playerPieces.get(t.type),a=e.cellComponents.get(t.currentPosition);if(n&&a){n.setPosition(a.x,a.y+15),n.m_icon&&(n.m_icon.scaleX=1)}})),this.updatePlayersZOrder()},o.updatePlayersZOrder=function(){var e=this,t=[];this.playerPieces.forEach((function(n,a){var i=e.players.find((function(e){return e.type===a}));if(n&&i){var r,s=(null==(r=e.players[e.currentPlayer])?void 0:r.type)===a;t.push({piece:n,y:n.y,playerName:i.name,playerType:a,isCurrentPlayer:s})}})),t.sort((function(e,t){return e.y!==t.y?e.y-t.y:e.isCurrentPlayer&&!t.isCurrentPlayer?1:!e.isCurrentPlayer&&t.isCurrentPlayer?-1:0})),t.forEach((function(e,n){if(e.piece.parent){var a=e.piece.parent.numChildren,i=Math.max(0,a-t.length)+n;e.piece.parent.setChildIndex(e.piece,Math.min(i,a-1))}}));var n=t.map((function(e){var t=e.isCurrentPlayer?"[当前]":"";return""+e.playerName+t+"(y:"+e.y.toFixed(1)+")"})).join(" < ");this._log.log("棋子层级排序: "+n+" (Y值小到大，层级低到高，相同Y值时当前玩家优先)")},o.moveCurrentPlayer=function(e){var t=this,n=this.players[this.currentPlayer],a=this.chessboardData.length,i=Math.min(n.currentPosition+e,a);this._log.log(n.name+" 从 "+n.currentPosition+" 移动到 "+i+" (总共"+a+"格)");var r=this.cellLogics.get(n.currentPosition);r&&r.removePiece(n.type),this.updatePlayersZOrder(),this.playMoveAnimation(n,i,(function(){if(t.gameState===v.游戏中){var e=t.cellLogics.get(i);if(e&&e.addPiece(n.type),n.currentPosition=i,t.updatePlayersZOrder(),i>=a)n.isFinished=!0,t._log.log(n.name+" 到达终点！"),t.checkGameEnd();else{var r=t.chessboardData.find((function(e){return e.number===i}));r&&r.specialId?t.showSpecialPopup(r.specialId,n):t.showTaskDialog(n)}}else t._log.log("游戏已停止，跳过移动完成后的逻辑")}))},o.showSpecialPopup=function(){var e=n(a().mark((function e(t,n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._log.log("触发特殊格子: "+t+" at "+n.currentPosition),e.t0=t,e.next=e.t0===g.SWAP?4:e.t0===g.PAUSE?7:e.t0===g.QUESTION?10:e.t0===g.DICE_PLUS_ONE?13:16;break;case 4:return e.next=6,s.open(I,{players:this.players});case 6:return e.abrupt("break",16);case 7:return e.next=9,s.open(G,{player:n});case 9:return e.abrupt("break",16);case 10:return e.next=12,s.open(k,{player:n});case 12:return e.abrupt("break",16);case 13:return e.next=15,s.open(E,{player:n});case 15:return e.abrupt("break",16);case 16:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),o.playMoveAnimation=function(e,t,n){var a=this.playerPieces.get(e.type);if(a){var i=this.calculateMovePath(e.currentPosition,t);this.moveAlongPath(a,i,0,n)}},o.calculateMovePath=function(e,t){for(var n=[],a=e+1;a<=t;a++)n.push(a);return n},o.moveAlongPath=function(e,t,n,a){var i=this;if(this.gameState===v.游戏中)if(n>=t.length)a();else{var s=t[n],o=this.cellComponents.get(s);if(o){var l=o.x,c=o.y+15,u=l-e.x,h=c-e.y;this.updatePieceDirection(e,u,h);var y=_.moveAnimation;r(this).delay(Math.max(0,.5*y.duration)).call((function(){i.gameState===v.游戏中&&i.playCellScaleAnimation(o,(function(){}))})).start(),r(e).to(.5*y.duration,{x:l-u/2,y:c-h/2,scaleX:y.middleScale,scaleY:y.middleScale}).to(.5*y.duration,{x:l,y:c,scaleX:y.endScale,scaleY:y.endScale}).call((function(){i.gameState===v.游戏中?(i.updatePlayersZOrder(),i.moveAlongPath(e,t,n+1,a)):i._log.log("动画完成时检测到游戏已停止，中断后续移动")})).start()}else this.moveAlongPath(e,t,n+1,a)}else this._log.log("游戏已停止，中断路径移动")},o.updatePieceDirection=function(e,t,n){if(e&&e.m_icon){var a=1;Math.abs(t)>Math.abs(n)?t>0?a=-1:t<0&&(a=1):Math.abs(n)>0&&(n>0?a=-1:n<0&&(a=1)),e.m_icon.scaleX=a,this._log.log("更新棋子朝向: moveX="+t.toFixed(1)+", moveY="+n.toFixed(1)+", scaleX="+a)}},o.playCellScaleAnimation=function(e,t){var n=this,a=_.moveAnimation;r(e).delay(.2*a.duration).call((function(){n.playMoveSound()})).to(.4*a.duration,{scaleX:.8,scaleY:.8}).call((function(){r(e).to(.4*a.duration,{scaleX:1,scaleY:1}).call((function(){t()})).start()})).start()},o.playMoveSound=function(){try{var e=S.getByName("Game");if(e){var t=e.getItemAssetByName("move");t&&b.inst.playOneShotSound(t)}}catch(e){this._log.log("播放移动音效失败:",e)}},o.playWinSound=function(){try{var e=S.getByName("Game");if(e){var t=e.getItemAssetByName("win");t&&b.inst.playOneShotSound(t)}}catch(e){this._log.log("播放胜利音效失败:",e)}},o.showWinScreen=function(){var e=n(a().mark((function e(t){var n,i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._log.log("显示胜利界面 - 获胜者: "+t.name+", 类型: "+t.type+", 角色ID: "+t.characterId),n={winner:t},e.next=4,s.open(d,n);case 4:x.once(x.key.WinScreenClosed,(function(){i.resetGame()}),this);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),o.resetGame=function(){var e=this;this.gameState=v.游戏中,this.currentPlayer=0,this.clearAllCellStates(),this.players.forEach((function(e){e.currentPosition=1,e.isFinished=!1})),this.updatePlayerPositions(),this.players.forEach((function(t){var n=e.cellLogics.get(t.currentPosition);n&&n.addPiece(t.type)})),this.updatePlayersZOrder();var t=this.players[this.currentPlayer];t&&(this.playPlayerTurnAnimation(t.type),x.emit(x.key.NextPlayerTurn,t)),this._log.log("游戏已重置，可以重新开始游戏")},o.clearAllCellStates=function(){this.cellLogics.forEach((function(e,t){e.clearAllPieces()})),this._log.log("已清理所有格子上的棋子状态")},o.stopGame=function(){this._log.log("停止游戏，设置游戏状态为暂停"),this.gameState=v.暂停,s.close(p)},o.nextPlayer=function(){var e,t=this;this._log.log("=== 切换玩家 ==="),this._log.log("切换前 - 当前玩家索引: "+this.currentPlayer+", 玩家: "+(null==(e=this.players[this.currentPlayer])?void 0:e.name)),this.hasExtraTurn?(this._log.log("触发幸运骰子：保持当前玩家，消耗一次额外回合"),this.hasExtraTurn=!1):this.currentPlayer=(this.currentPlayer+1)%this.players.length;var n=this.players[this.currentPlayer];if(this._log.log("切换后 - 当前玩家索引: "+this.currentPlayer+", 玩家: "+n.name+", 类型: "+n.type),this.playPlayerTurnAnimation(n.type),this.pausedPlayers.has(n.type)){this._log.log("玩家 "+n.name+" 本回合被暂停，播放m_t1并跳过行动");var a=this.playerPieces.get(n.type);if(a&&a.m_t1&&"function"==typeof a.m_t1.play){try{a.m_t1.play((function(){a.m_c3&&(a.m_c3.selectedIndex=0),t.pausedPlayers.delete(n.type),t.nextPlayer()}),1,0)}catch(e){null!=a&&a.m_c3&&(a.m_c3.selectedIndex=0),this.pausedPlayers.delete(n.type),this.nextPlayer()}return}return null!=a&&a.m_c3&&(a.m_c3.selectedIndex=0),this.pausedPlayers.delete(n.type),void this.nextPlayer()}x.emit(x.key.NextPlayerTurn,n)},o.playPlayerTurnAnimation=function(e){var t=this.UI.parent;t?e===P.P1?t.m_t0&&(t.m_t0.play(),this._log.log("播放P1玩家轮次动画 (t0)")):e===P.P2&&t.m_t1&&(t.m_t1.play(),this._log.log("播放P2玩家轮次动画 (t1)")):this._log.log("无法获取Game_Main组件，跳过动画播放")},o.showTaskDialog=function(){var e=n(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._log.log("显示任务对话框 - 当前玩家: "+t.name+", 角色ID: "+t.characterId),n=C.getRandomTaskForPositionSync(t.currentPosition,t),this._log.log("获取到的任务: ID="+n.id),e.next=5,s.open(p,n);case 5:e.sent;case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),o.checkGameEnd=function(){var e=this.players.filter((function(e){return e.isFinished}));if(e.length>0){this.gameState=v.结束;var t=e[0];this._log.log("游戏结束！获胜者：",t.name),this.playWinSound(),this.showWinScreen(t),x.emit(x.key.GameEnded,t)}},o.startGame=function(){this.gameState=v.游戏中,this.currentPlayer=0;var e=this.players[this.currentPlayer];e&&this.playPlayerTurnAnimation(e.type),this._log.log("游戏开始！轮到",this.players[this.currentPlayer].name)},o.canRollDice=function(){return this.gameState===v.游戏中&&!this.isPlayerMoving()},o.handleDiceResult=function(e){this.gameState===v.游戏中&&(this._log.log(this.players[this.currentPlayer].name+" 摇骰子结果: "+e.value),this.moveCurrentPlayer(e.value))},o.isPlayerMoving=function(){return this.diceLogic&&this.diceLogic.getIsAnimating()},o.onCellClick=function(e){this._log.log("点击了格子:",e);var t=this.chessboardData.find((function(t){return t.number===e}));t&&this._log.log("格子信息:",{"编号":t.number,"状态":t.style,"位置":t.gridPos})},o.clearChessboard=function(){this.cellComponents.forEach((function(e){e.parent&&e.parent.removeChild(e),e.dispose()})),this.cellComponents.clear(),this.chessboardData=[],this.gridMap.clear()},o.clearPlayers=function(){this.playerPieces.forEach((function(e){e.dispose()})),this.playerPieces.clear(),this.players=[],this.currentPlayer=0},o.getCellComponent=function(e){return this.cellComponents.get(e)},o.getCellDataByGrid=function(e,t){var n=f.getGridKey(e,t);return this.gridMap.get(n)},o.getAllCellData=function(){return[].concat(this.chessboardData)},o.updateChessboard=function(e){this.generateChessboard(e)},o.onDestroy=function(){x.targetOff(this),this.clearChessboard(),this.clearPlayers(),s.close(p)},i}(l))||D);i._RF.pop()}}}));

System.register("chunks:///_virtual/Game_List.ts",["./rollupPluginModLoBabelHelpers.js","cc","./fairygui.mjs","./drongo-gui.mjs"],(function(t){var e,n,i,c,o;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy},function(t){i=t.UIPackage,c=t.GComponent},function(t){o=t.vm}],execute:function(){var r,s;n._RF.push({},"3ac27QcEbZEe61ILSdWPDLX","Game_List",void 0);t("default",o(((s=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),c=0;c<n;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))||this).m_list=void 0,e}return e(n,t),n.createInstance=function(){return i.createObject("Game","List")},n.prototype.onConstruct=function(){this.m_list=this.getChild("list")},n}(c)).URL="ui://bpp6st2qme221l",s.Dependencies=["Game"],r=s))||r);n._RF.pop()}}}));

System.register("chunks:///_virtual/Game_LukyTouZi_Logic.ts",["./rollupPluginModLoBabelHelpers.js","cc","./drongo-gui.mjs","./GameEvents.ts","./Game_LukyTouZi.ts","./TaskDialogWindow.ts"],(function(t){var n,i,o,a,e,u,r,s,c;return{setters:[function(t){n=t.inheritsLoose},function(t){i=t.cclegacy},function(t){o=t.UILayer,a=t.addLogic,e=t.GUIManager,u=t.GUILogicBase},function(t){r=t.gameEvent},function(t){s=t.default},function(t){c=t.TaskDialogWindow}],execute:function(){var l,f;i._RF.push({},"fdbabiH5A9D6atGp6Q0gigF","Game_LukyTouZi_Logic",void 0);t("default",a(s)(((f=function(t){function i(){return t.apply(this,arguments)||this}n(i,t);var o=i.prototype;return o.onLoad=function(){var t=this;this.UI.m_okBtn.onClick((function(){var n=t.Data;null!=n&&n.player&&r.emit(r.key.LuckyExtraTurn,{player:n.player}),e.close(s)}),this)},o.start=function(){},i}(u)).uiOptions={layer:o.TIP,modal:!0,windowCls:c},l=f))||l);i._RF.pop()}}}));

System.register("chunks:///_virtual/Game_LukyTouZi.ts",["./rollupPluginModLoBabelHelpers.js","cc","./fairygui.mjs","./drongo-gui.mjs"],(function(n){var t,e,o,i,u;return{setters:[function(n){t=n.inheritsLoose},function(n){e=n.cclegacy},function(n){o=n.UIPackage,i=n.GComponent},function(n){u=n.vm}],execute:function(){var c,r;e._RF.push({},"0418cTY3ExAyIQsMDSnoMnl","Game_LukyTouZi",void 0);n("default",u(((r=function(n){function e(){for(var t,e=arguments.length,o=new Array(e),i=0;i<e;i++)o[i]=arguments[i];return(t=n.call.apply(n,[this].concat(o))||this).m_okBtn=void 0,t}return t(e,n),e.createInstance=function(){return o.createObject("Game","LukyTouZi")},e.prototype.onConstruct=function(){this.m_okBtn=this.getChild("okBtn")},e}(i)).URL="ui://bpp6st2qjh785i",r.Dependencies=["Game"],c=r))||c);e._RF.pop()}}}));

System.register("chunks:///_virtual/Game_Main_Logic.ts",["./rollupPluginModLoBabelHelpers.js","cc","./drongo-gui.mjs","./Game_Main.ts","./Game_List_Logic.ts","./Game_DiuTouZi.ts","./Game_SelectGender.ts","./ChessboardExamples.ts","./GameEvents.ts","./PlayerDataModel.ts","./fairygui.mjs"],(function(t){var i,e,o,n,s,l,a,c,r,u,h,g,d,m;return{setters:[function(t){i=t.inheritsLoose},function(t){e=t.cclegacy,o=t.AudioSourceComponent},function(t){n=t.GUIManager,s=t.GUILogicBase,l=t.addLogic},function(t){a=t.default},function(t){c=t.default},function(t){r=t.default},function(t){u=t.default},function(t){h=t.DefaultChessboardConfig},function(t){g=t.gameEvent},function(t){d=t.playerDataModel},function(t){m=t.UIPackage}],execute:function(){var f;e._RF.push({},"6414axnOOZKdLMRghXK77up","Game_Main_Logic",void 0);t("default",l(a)(f=function(t){function e(){for(var i,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(i=t.call.apply(t,[this].concat(o))||this).listLogic=void 0,i}i(e,t);var s=e.prototype;return s.start=function(){var t=this;this.listLogic=this.UI.m_list.Get(c),this.listLogic?this.initGame():this.scheduleOnce((function(){t.listLogic=t.UI.m_list.Get(c),t.listLogic&&t.initGame()}),.1),this.setupEventListeners()},s.setupEventListeners=function(){this.UI.m_roll.onClick(this.onRollClick,this),this.UI.m_back.onClick(this.onBackClick,this),g.on(g.key.DiceRolled,this.onDiceRolled,this),g.on(g.key.NextPlayerTurn,this.onNextPlayerTurn,this),g.on(g.key.GameEnded,this.onGameEnded,this)},s.onRollClick=function(){this.UI.m_roll.enabled&&this.listLogic&&this.listLogic.canRollDice()&&(this._log.log("点击投骰子按钮，打开骰子界面"),this.UI.m_roll.enabled=!1,n.open(r))},s.onDiceRolled=function(t){this._log.log("收到骰子结果: "+t.value),this.listLogic&&this.listLogic.handleDiceResult(t)},s.onNextPlayerTurn=function(t){this._log.log("下一个玩家轮次开始，重新启用投骰子按钮 - 当前玩家: "+t.name),this.UI.m_roll.enabled=!0},s.onGameEnded=function(t){this._log.log("游戏结束，禁用投骰子按钮 - 获胜者: "+t.name),this.UI.m_roll.enabled=!1},s.onBackClick=function(){this._log.log("返回角色选择界面"),this.listLogic&&this.listLogic.stopGame(),n.close(a),n.open(u)},s.initGame=function(){this._log.log("初始化飞行棋游戏");var t=d.player1CharacterId,i=d.player2CharacterId;this._log.log("P1选择角色ID: "+t+", P2选择角色ID: "+i),this.listLogic.generateChessboard(h),this.listLogic.initializePlayers(t,i),this.listLogic.startGame(),this.UI.m_roll.enabled=!0,this._log.log("游戏初始化完成，启用投骰子按钮")},s.restartGame=function(){this.UI.m_roll.enabled=!1,this.initGame()},s.getListLogic=function(){return this.listLogic},s.playBGM=function(t,i,e){var n=m.getByName(i).getItemAssetByName(e),s=t.addComponent(o);return s.isValid&&(s.clip=n,s.volume=1,s.loop=!0,s.play()),s},s.onDestroy=function(){g.targetOff(this),t.prototype.onDestroy.call(this)},e}(s))||f);e._RF.pop()}}}));

System.register("chunks:///_virtual/Game_Main.ts",["./rollupPluginModLoBabelHelpers.js","cc","./fairygui.mjs","./drongo-gui.mjs"],(function(t){var i,n,e,o,s;return{setters:[function(t){i=t.inheritsLoose},function(t){n=t.cclegacy},function(t){e=t.UIPackage,o=t.GComponent},function(t){s=t.vm}],execute:function(){var r,a;n._RF.push({},"64803VbHF1B/ItvafCsZQRz","Game_Main",void 0);t("default",s(((a=function(t){function n(){for(var i,n=arguments.length,e=new Array(n),o=0;o<n;o++)e[o]=arguments[o];return(i=t.call.apply(t,[this].concat(e))||this).m_list=void 0,i.m_back=void 0,i.m_info=void 0,i.m_roll=void 0,i.m_t0=void 0,i.m_t1=void 0,i}return i(n,t),n.createInstance=function(){return e.createObject("Game","Main")},n.prototype.onConstruct=function(){this.m_list=this.getChild("list"),this.m_back=this.getChild("back"),this.m_info=this.getChild("info"),this.m_roll=this.getChild("roll"),this.m_t0=this.getTransition("t0"),this.m_t1=this.getTransition("t1")},n}(o)).URL="ui://bpp6st2qfm8yl",a.Dependencies=["Game"],r=a))||r);n._RF.pop()}}}));

System.register("chunks:///_virtual/Game_Peaple_Logic.ts",["./rollupPluginModLoBabelHelpers.js","cc","./drongo-gui.mjs","./Game_Peaple.ts"],(function(e){var o,t,n,i,u;return{setters:[function(e){o=e.inheritsLoose},function(e){t=e.cclegacy},function(e){n=e.GUILogicBase,i=e.addLogic},function(e){u=e.default}],execute:function(){var c;t._RF.push({},"336d82rNwhObboxr1lezYPh","Game_Peaple_Logic",void 0);e("default",i(u)(c=function(e){function t(){return e.apply(this,arguments)||this}return o(t,e),t.prototype.onLoad=function(){n.setSortRoot(this.node,!0)},t}(n))||c);t._RF.pop()}}}));

System.register("chunks:///_virtual/Game_Peaple.ts",["./rollupPluginModLoBabelHelpers.js","cc","./fairygui.mjs","./drongo-gui.mjs"],(function(t){var e,i,n,o,c;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy},function(t){n=t.UIPackage,o=t.GComponent},function(t){c=t.vm}],execute:function(){var r,s;i._RF.push({},"ef78ajW2VxGTJw4aMGHudCL","Game_Peaple",void 0);t("default",c(((s=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).m_c1=void 0,e.m_c2=void 0,e.m_c3=void 0,e.m_icon=void 0,e.m_t0=void 0,e.m_t1=void 0,e}return e(i,t),i.createInstance=function(){return n.createObject("Game","Peaple")},i.prototype.onConstruct=function(){this.m_c1=this.getController("c1"),this.m_c2=this.getController("c2"),this.m_c3=this.getController("c3"),this.m_icon=this.getChild("icon"),this.m_t0=this.getTransition("t0"),this.m_t1=this.getTransition("t1")},i}(o)).URL="ui://bpp6st2qme221o",s.Dependencies=["Game"],r=s))||r);i._RF.pop()}}}));

System.register("chunks:///_virtual/Game_SelectGender_Logic.ts",["./rollupPluginModLoBabelHelpers.js","cc","./drongo-gui.mjs","./PlayerDataModel.ts","./Game_SelectGender.ts","./Game_JueSeSelect_Logic.ts","./Game_Main.ts"],(function(e){var t,i,n,r,o,c,a,s,l,u,p;return{setters:[function(e){t=e.inheritsLoose,i=e.asyncToGenerator,n=e.regeneratorRuntime},function(e){r=e.cclegacy},function(e){o=e.addLogic,c=e.GUILogicBase,a=e.GUIManager},function(e){s=e.playerDataModel},function(e){l=e.default},function(e){u=e.default},function(e){p=e.default}],execute:function(){var h;r._RF.push({},"f5a9aD1OH1Eibrb+ZPihRMI","Game_SelectGender_Logic",void 0);e("default",o(l)(h=function(e){function r(){for(var t,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))||this).p1Logic=void 0,t.p2Logic=void 0,t}t(r,e);var o=r.prototype;return o.onLoad=function(){this.initializePlayerSelections(),this.setupEventListeners()},o.initializePlayerSelections=function(){this.p1Logic=this.UI.m_P1.Get(u),this.p2Logic=this.UI.m_P2.Get(u),this.p1Logic&&this.p1Logic.initializeForPlayer(1),this.p2Logic&&this.p2Logic.initializeForPlayer(2)},o.setupEventListeners=function(){this.UI.m_ok.onClick(this.onConfirmClick,this)},o.onConfirmClick=function(){var e=this.p1Logic?this.p1Logic.getCurrentIndex():0,t=this.p2Logic?this.p2Logic.getCurrentIndex():1;s.setPlayer1Character(e),s.setPlayer2Character(t),this._log.log("角色选择完成 - P1: "+e+", P2: "+t),this.enterGame()},o.enterGame=function(){var e=i(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.close(l),e.next=4,a.open(p);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error("进入游戏失败:",e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),r}(c))||h);r._RF.pop()}}}));

System.register("chunks:///_virtual/Game_SelectGender.ts",["./rollupPluginModLoBabelHelpers.js","cc","./fairygui.mjs","./drongo-gui.mjs"],(function(e){var t,n,i,o,c;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy},function(e){i=e.UIPackage,o=e.GComponent},function(e){c=e.vm}],execute:function(){var r,s;n._RF.push({},"c5caeCAa19GGIGgHYueihJl","Game_SelectGender",void 0);e("default",c(((s=function(e){function n(){for(var t,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))||this).m_P1=void 0,t.m_P2=void 0,t.m_ok=void 0,t}return t(n,e),n.createInstance=function(){return i.createObject("Game","SelectGender")},n.prototype.onConstruct=function(){this.m_P1=this.getChild("P1"),this.m_P2=this.getChild("P2"),this.m_ok=this.getChild("ok")},n}(o)).URL="ui://bpp6st2qdosa2j",s.Dependencies=["Game"],r=s))||r);n._RF.pop()}}}));

System.register("chunks:///_virtual/Game_Succ_Logic.ts",["./rollupPluginModLoBabelHelpers.js","cc","./drongo-gui.mjs","./Game_Succ.ts","./Game_SelectGender.ts","./GameEvents.ts","./WinDialogWindow.ts","./Game_Main.ts"],(function(e){var t,n,i,o,c,s,a,r,l,u,h;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy},function(e){i=e.UILayer,o=e.addLogic,c=e.GUIManager,s=e.GUILogicBase},function(e){a=e.default},function(e){r=e.default},function(e){l=e.gameEvent},function(e){u=e.WinDialogWindow},function(e){h=e.default}],execute:function(){var d,m;n._RF.push({},"229b4jeKDdOy6nhec1eeLHP","Game_Succ_Logic",void 0);e("default",o(a)(((m=function(e){function n(){return e.apply(this,arguments)||this}t(n,e);var i=n.prototype;return i.onLoad=function(){this.setupUI(),this.setupEventListeners()},i.setupUI=function(){var e=this.Data;if(e&&e.winner){var t=e.winner;this._log.log("显示胜利界面 - 获胜者: "+t.name+", 角色ID: "+t.characterId);var n="P1"===t.name?0:1;this.UI.m_c1.selectedIndex=n,this.UI.m_people&&"number"==typeof t.characterId&&(this.UI.m_people.m_c1.selectedIndex=t.characterId,this._log.log("设置角色显示 - m_c1: "+n+", m_c2: "+t.characterId))}else console.error("未找到获胜者数据")},i.setupEventListeners=function(){this.UI.m_home.onClick(this.onHomeClick,this),this.UI.m_btn.onClick(this.onRestartClick,this)},i.onHomeClick=function(){this._log.log("返回角色选择界面"),c.close(a),c.open(r),c.close(h)},i.onRestartClick=function(){this._log.log("重新开始游戏"),l.emit(l.key.WinScreenClosed),c.close(a)},n}(s)).uiOptions={layer:i.TIP,modal:!0,windowCls:u},d=m))||d);n._RF.pop()}}}));

System.register("chunks:///_virtual/Game_Succ.ts",["./rollupPluginModLoBabelHelpers.js","cc","./fairygui.mjs","./drongo-gui.mjs"],(function(t){var e,i,n,o,c;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy},function(t){n=t.UIPackage,o=t.GComponent},function(t){c=t.vm}],execute:function(){var r,s;i._RF.push({},"073b9pwT8dHpKgcmH5r/0QP","Game_Succ",void 0);t("default",c(((s=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).m_c1=void 0,e.m_title=void 0,e.m_btn=void 0,e.m_people=void 0,e.m_home=void 0,e}return e(i,t),i.createInstance=function(){return n.createObject("Game","Succ")},i.prototype.onConstruct=function(){this.m_c1=this.getController("c1"),this.m_title=this.getChild("title"),this.m_btn=this.getChild("btn"),this.m_people=this.getChild("people"),this.m_home=this.getChild("home")},i}(o)).URL="ui://bpp6st2qdosa4r",s.Dependencies=["Game"],r=s))||r);i._RF.pop()}}}));

System.register("chunks:///_virtual/Game_Touzi_Logic.ts",["./rollupPluginModLoBabelHelpers.js","cc","./drongo-gui.mjs","./Game_Touzi.ts","./drongo-cc.mjs"],(function(t){var e,i,n,o,s,a,u,r,c,h;return{setters:[function(t){e=t.inheritsLoose,i=t.createForOfIteratorHelperLoose,n=t.asyncToGenerator,o=t.regeneratorRuntime},function(t){s=t.cclegacy,a=t.JsonAsset},function(t){u=t.addLogic,r=t.GUILogicBase},function(t){c=t.default},function(t){h=t.asset}],execute:function(){var l,g;s._RF.push({},"393b9JrtzNJzopm1xE5p6FW","Game_Touzi_Logic",void 0);t("default",u(c)(((g=function(t){function s(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))||this).isAnimating=!1,e.onAnimationComplete=void 0,e.cumulativeWeights=[],e.totalWeight=0,e}e(s,t);var u=s.prototype;return u.onLoad=function(){var t=this;this.tryLoadDiceWeightsFromResources().then((function(){t.initializeCumulativeWeights()})).catch((function(){t.computeDefaultWeights(),t.initializeCumulativeWeights()})),this.UI.m_c1.selectedIndex=0},u.initializeCumulativeWeights=function(){6!==s.DICE_WEIGHTS.length&&this.computeDefaultWeights(),s.DICE_WEIGHTS=s.DICE_WEIGHTS.map((function(t){return{value:t.value,weight:Math.max(0,Number(t.weight)||0)}})),s.DICE_WEIGHTS.sort((function(t,e){return t.value-e.value})),this.totalWeight=s.DICE_WEIGHTS.reduce((function(t,e){return t+e.weight}),0),this.totalWeight<=0&&(console.warn("骰子权重总和<=0，使用默认等分权重"),this.computeDefaultWeights(),this.totalWeight=s.DICE_WEIGHTS.reduce((function(t,e){return t+e.weight}),0)),this.cumulativeWeights=[];for(var t,e=0,n=i(s.DICE_WEIGHTS);!(t=n()).done;){e+=t.value.weight,this.cumulativeWeights.push(e)}this._log.log("骰子概率配置:",s.DICE_WEIGHTS.map((function(t){return t.value+"点:"+t.weight})).join(", "))},u.tryLoadDiceWeightsFromResources=function(){var t=n(o().mark((function t(){var e,i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,h.get("Game/DiceConfig",a,null);case 3:e=t.sent,i=e.json,Array.isArray(null==i?void 0:i.weights)&&6===i.weights.length?s.DICE_WEIGHTS=i.weights.map((function(t){return{value:t.value,weight:t.weight}})):this.computeDefaultWeights(),e.decRef(),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),console.warn("读取骰子配置失败，使用默认权重:",t.t0),this.computeDefaultWeights();case 13:case"end":return t.stop()}}),t,this,[[0,9]])})));return function(){return t.apply(this,arguments)}}(),u.computeDefaultWeights=function(){for(var t=Math.floor(100/6),e=100-6*t,i=[],n=1;n<=6;n++){var o=e>0?1:0;i.push({value:n,weight:t+o}),e>0&&e--}s.DICE_WEIGHTS=i},u.onDiceClick=function(){this.isAnimating||this.playDiceAnimation()},u.generateWeightedDiceResult=function(){for(var t=this.totalWeight>0?this.totalWeight:100,e=Math.random()*t,i=0,n=this.cumulativeWeights.length-1;i<n;){var o=i+n>>>1;e<this.cumulativeWeights[o]?n=o:i=o+1}return s.DICE_WEIGHTS[i].value},u.selfTestDistribution=function(t){void 0===t&&(t=1e4);for(var e={1:0,2:0,3:0,4:0,5:0,6:0},i=0;i<t;i++){var n=this.generateWeightedDiceResult();e[n]=(e[n]||0)+1}var o=[1,2,3,4,5,6].map((function(i){return i+":"+(e[i]/t*100).toFixed(2)+"%"})).join(", ");this._log.log("Dice分布("+t+"次): "+o)},u.playDiceAnimation=function(t){var e=this;if(!this.isAnimating){this.isAnimating=!0,this.onAnimationComplete=t;var i=this.generateWeightedDiceResult(),n=function(t){var e=t/24;return e<.3?.015:e<.7?.025:.04},o=0,s=1;this.UI.m_c1.selectedIndex=0,this.UI.m_c2.selectedIndex=s;for(var a=0,u=0;u<24;u++)a+=n(u);this._log.log("🎲 开始骰子动画 - 目标结果:"+i+"点，总时长:"+a.toFixed(2)+"秒");!function t(){if(o>=24){e.UI.m_c1.selectedIndex=i-1,e.UI.m_c2.selectedIndex=0,e.isAnimating=!1;var a={value:i};return e.onAnimationComplete&&e.onAnimationComplete(a),void e._log.log("🎯 骰子动画完成！最终结果: "+i+"点")}e.UI.m_c2.selectedIndex=s,++s>4&&(s=1),o++;var u=n(o-1);e.scheduleOnce((function(){t()}),u)}()}},u.setDiceValue=function(t){t>=1&&t<=6&&(this.UI.m_c1.selectedIndex=t-1)},u.getCurrentValue=function(){return this.UI.m_c1.selectedIndex+1},u.getIsAnimating=function(){return this.isAnimating},u.stopAnimation=function(){this.isAnimating&&(this.isAnimating=!1,this.onAnimationComplete=void 0,this.unscheduleAllCallbacks(),this.UI.m_c2.selectedIndex=0,this._log.log("🛑 骰子动画已强制停止"))},u.onDestroy=function(){this.stopAnimation()},s}(r)).DICE_WEIGHTS=[],l=g))||l);s._RF.pop()}}}));

System.register("chunks:///_virtual/Game_Touzi.ts",["./rollupPluginModLoBabelHelpers.js","cc","./fairygui.mjs","./drongo-gui.mjs"],(function(t){var e,n,i,o,c;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy},function(t){i=t.UIPackage,o=t.GButton},function(t){c=t.vm}],execute:function(){var r,u;n._RF.push({},"b0b312XQExF7q+IduSduKqZ","Game_Touzi",void 0);t("default",c(((u=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).m_c1=void 0,e.m_c2=void 0,e.m_t0=void 0,e}return e(n,t),n.createInstance=function(){return i.createObject("Game","Touzi")},n.prototype.onConstruct=function(){this.m_c1=this.getController("c1"),this.m_c2=this.getController("c2"),this.m_t0=this.getTransition("t0")},n}(o)).URL="ui://bpp6st2qme221m",u.Dependencies=["Game"],r=u))||r);n._RF.pop()}}}));

System.register("chunks:///_virtual/Game_WenHao_Logic.ts",["./rollupPluginModLoBabelHelpers.js","cc","./drongo-gui.mjs","./GameEvents.ts","./Game_WenHao.ts","./TaskDialogWindow.ts"],(function(n){var t,e,o,i,a,u,r,s,c;return{setters:[function(n){t=n.inheritsLoose},function(n){e=n.cclegacy},function(n){o=n.UILayer,i=n.addLogic,a=n.GUIManager,u=n.GUILogicBase},function(n){r=n.gameEvent},function(n){s=n.default},function(n){c=n.TaskDialogWindow}],execute:function(){var l,p;e._RF.push({},"b6b7cSYdGdKHYVNmzSvbXTB","Game_WenHao_Logic",void 0);n("default",i(s)(((p=function(n){function e(){return n.apply(this,arguments)||this}t(e,n);var o=e.prototype;return o.onLoad=function(){var n=this;this.UI.m_btn.onClick((function(){var t=n.Data;null!=t&&t.player&&(r.emit(r.key.QuestionPopupContinue,{player:t.player}),r.emit(r.key.NextPlayerTurn,t.player)),a.close(s)}),this)},o.start=function(){},e}(u)).uiOptions={layer:o.TIP,modal:!0,windowCls:c},l=p))||l);e._RF.pop()}}}));

System.register("chunks:///_virtual/Game_WenHao.ts",["./rollupPluginModLoBabelHelpers.js","cc","./fairygui.mjs","./drongo-gui.mjs"],(function(t){var e,n,i,o,c;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy},function(t){i=t.UIPackage,o=t.GComponent},function(t){c=t.vm}],execute:function(){var r,s;n._RF.push({},"c55b79mQTtDVYfmT01kZLdx","Game_WenHao",void 0);t("default",c(((s=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).m_c1=void 0,e.m_c2=void 0,e.m_title=void 0,e.m_content=void 0,e.m_btn=void 0,e}return e(n,t),n.createInstance=function(){return i.createObject("Game","WenHao")},n.prototype.onConstruct=function(){this.m_c1=this.getController("c1"),this.m_c2=this.getController("c2"),this.m_title=this.getChild("title"),this.m_content=this.getChild("content"),this.m_btn=this.getChild("btn")},n}(o)).URL="ui://bpp6st2qjh785n",s.Dependencies=["Game"],r=s))||r);n._RF.pop()}}}));

System.register("chunks:///_virtual/Game_ZhanTingHuiHe_Logic.ts",["./rollupPluginModLoBabelHelpers.js","cc","./drongo-gui.mjs","./GameEvents.ts","./Game_ZhanTingHuiHe.ts","./TaskDialogWindow.ts"],(function(e){var t,n,i,a,o,c,r,s,u;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy},function(e){i=e.UILayer,a=e.addLogic,o=e.GUIManager,c=e.GUILogicBase},function(e){r=e.gameEvent},function(e){s=e.default},function(e){u=e.TaskDialogWindow}],execute:function(){var l,d;n._RF.push({},"1eb0bg7jgxINoYva0qC2vGr","Game_ZhanTingHuiHe_Logic",void 0);e("default",a(s)(((d=function(e){function n(){return e.apply(this,arguments)||this}t(n,e);var i=n.prototype;return i.onLoad=function(){var e=this;this.UI.m_okBtn.onClick((function(){var t=e.Data,n=null==t?void 0:t.player;n&&r.emit(r.key.PauseTurnRequested,{player:n}),o.close(s)}),this)},i.start=function(){var e=this.Data,t=null==e?void 0:e.player;try{if(t&&"number"==typeof t.characterId&&(this.UI.m_people.m_c1.selectedIndex=t.characterId,this.UI.m_people.m_c2)){var n="P1"===t.name?0:1;this.UI.m_people.m_c2.selectedIndex=n}}catch(e){}},n}(c)).uiOptions={layer:i.TIP,modal:!0,windowCls:u},l=d))||l);n._RF.pop()}}}));

System.register("chunks:///_virtual/Game_ZhanTingHuiHe.ts",["./rollupPluginModLoBabelHelpers.js","cc","./fairygui.mjs","./drongo-gui.mjs"],(function(e){var n,t,i,o,c;return{setters:[function(e){n=e.inheritsLoose},function(e){t=e.cclegacy},function(e){i=e.UIPackage,o=e.GComponent},function(e){c=e.vm}],execute:function(){var u,r;t._RF.push({},"0c311M8U5FBAJzCsFnmXE6x","Game_ZhanTingHuiHe",void 0);e("default",c(((r=function(e){function t(){for(var n,t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return(n=e.call.apply(e,[this].concat(i))||this).m_okBtn=void 0,n.m_people=void 0,n}return n(t,e),t.createInstance=function(){return i.createObject("Game","ZhanTingHuiHe")},t.prototype.onConstruct=function(){this.m_okBtn=this.getChild("okBtn"),this.m_people=this.getChild("people")},t}(o)).URL="ui://bpp6st2qjh785l",r.Dependencies=["Game"],u=r))||u);t._RF.pop()}}}));

System.register("chunks:///_virtual/GameBinder.ts",["cc","./drongo-gui.mjs","./fairygui.mjs","./Game_SelectGender.ts","./Game_JueSeSelect.ts","./Game_DiuTouZi.ts","./Game_Button7.ts","./Game_Succ.ts","./Game_Button9.ts","./Game_Main.ts","./Game_JiaoHuanWeiZi.ts","./Game_LukyTouZi.ts","./Game_ZhanTingHuiHe.ts","./Game_WenHao.ts","./Game_Cell.ts","./Game_List.ts","./Game_Touzi.ts","./Game_Peaple.ts","./Game_Dialog.ts"],(function(t){var e,n,i,u,s,o,a,f,c,l,d,m,r,x,G,_,E,L,R;return{setters:[function(t){e=t.cclegacy},function(t){n=t.registerBinder},function(t){i=t.UIObjectFactory},function(t){u=t.default},function(t){s=t.default},function(t){o=t.default},function(t){a=t.default},function(t){f=t.default},function(t){c=t.default},function(t){l=t.default},function(t){d=t.default},function(t){m=t.default},function(t){r=t.default},function(t){x=t.default},function(t){G=t.default},function(t){_=t.default},function(t){E=t.default},function(t){L=t.default},function(t){R=t.default}],execute:function(){var U;e._RF.push({},"de59ahxwbxAXYHC/EFeTEKF","GameBinder",void 0);t("default",n(U=function(){function t(){}return t.prototype.bindAll=function(){i.setExtension(u.URL,u),i.setExtension(s.URL,s),i.setExtension(o.URL,o),i.setExtension(a.URL,a),i.setExtension(f.URL,f),i.setExtension(c.URL,c),i.setExtension(l.URL,l),i.setExtension(d.URL,d),i.setExtension(m.URL,m),i.setExtension(r.URL,r),i.setExtension(x.URL,x),i.setExtension(G.URL,G),i.setExtension(_.URL,_),i.setExtension(E.URL,E),i.setExtension(L.URL,L),i.setExtension(R.URL,R)},t}())||U);e._RF.pop()}}}));

System.register("chunks:///_virtual/GameEvents.ts",["cc","./drongo-cc.mjs"],(function(e){var t,n;return{setters:[function(e){t=e.cclegacy},function(e){n=e.event_target}],execute:function(){t._RF.push({},"b5fc6kDkK1ISKsbd/iDCyCW","GameEvents",void 0);e("gameEvent",new n);t._RF.pop()}}}));

System.register("chunks:///_virtual/GameTypes.ts",["cc"],(function(e){var n;return{setters:[function(e){n=e.cclegacy}],execute:function(){n._RF.push({},"8538fcy9OhMFJZKxitfnwsd","GameTypes",void 0);e("PlayerType",function(e){return e[e.P1=0]="P1",e[e.P2=1]="P2",e}({})),e("TaskCategory",function(e){return e.DAILY_INTERACTION="A",e.INTIMATE_CHALLENGE="B",e.RANDOM_SURPRISE="C",e}({})),e("GameState",function(e){return e[e["准备中"]=0]="准备中",e[e["游戏中"]=1]="游戏中",e[e["暂停"]=2]="暂停",e[e["结束"]=3]="结束",e}({})),e("DefaultGameConfig",{moveAnimation:{duration:.5,easing:7,middleScale:1.2,endScale:1},diceAnimationTime:1});n._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./CommonExport.ts","./ConfigBase.ts","./ChessboardConfigUtils.ts","./ChessboardExamples.ts","./ChessboardGenerator.ts","./GameEvents.ts","./ConfigMgr.ts","./PoolMgr.ts","./TaskManager.ts","./ChessboardTypes.ts","./GameTypes.ts","./PlayerDataModel.ts","./StartView.ts","./GameBinder.ts","./Game_Button1.ts","./Game_Button7.ts","./Game_Button9.ts","./Game_Cell.ts","./Game_Cell_Logic.ts","./Game_Dialog.ts","./Game_Dialog_Logic.ts","./Game_DiuTouZi.ts","./Game_DiuTouZi_Logic.ts","./Game_JiaoHuanWeiZi.ts","./Game_JiaoHuanWeiZi_Logic.ts","./Game_JueSeSelect.ts","./Game_JueSeSelect_Logic.ts","./Game_List.ts","./Game_List_Logic.ts","./Game_LukyTouZi.ts","./Game_LukyTouZi_Logic.ts","./Game_Main.ts","./Game_Main_Logic.ts","./Game_Peaple.ts","./Game_Peaple_Logic.ts","./Game_SelectGender.ts","./Game_SelectGender_Logic.ts","./Game_Succ.ts","./Game_Succ_Logic.ts","./Game_Touzi.ts","./Game_Touzi_Logic.ts","./Game_WenHao.ts","./Game_WenHao_Logic.ts","./Game_ZhanTingHuiHe.ts","./Game_ZhanTingHuiHe_Logic.ts","./TaskDialogWindow.ts","./WinDialogWindow.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/PlayerDataModel.ts",["./rollupPluginModLoBabelHelpers.js","cc","./drongo-cc.mjs"],(function(a){var t,r,e,n;return{setters:[function(a){t=a.inheritsLoose,r=a.createClass},function(a){e=a.cclegacy},function(a){n=a.IDataModel}],execute:function(){e._RF.push({},"2866dcyiSJImZDjn/EcWxMY","PlayerDataModel",void 0);var c=function(){this.isInGame=!1,this.currentRound=0,this.currentPlayer=1};a("playerDataModel",new(function(a){function e(){return a.apply(this,arguments)||this}t(e,a);var n=e.prototype;return n.clearGameData=function(){var a=new c;Object.assign(this.dRunData,a)},n.getPlayerCharacterId=function(a){return 1===a?this.dLocalData.player1CharacterId:this.dLocalData.player2CharacterId},n.setPlayerCharacter=function(a,t){return!(t<0)&&(1===a?this.dLocalData.player1CharacterId=t:this.dLocalData.player2CharacterId=t,!0)},n.setPlayer1Character=function(a){return this.setPlayerCharacter(1,a)},n.setPlayer2Character=function(a){return this.setPlayerCharacter(2,a)},r(e,[{key:"player1CharacterId",get:function(){return this.dLocalData.player1CharacterId}},{key:"player2CharacterId",get:function(){return this.dLocalData.player2CharacterId}}]),e}(n))(new function(){this.player1CharacterId=0,this.player2CharacterId=1},new c));e._RF.pop()}}}));

System.register("chunks:///_virtual/PoolMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./drongo-cc.mjs","./fairygui.mjs","./drongo-gui.mjs"],(function(e){var t,n,r,o,a,i,s,c,u,l,f,p,h,b;return{setters:[function(e){t=e.inheritsLoose,n=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){o=e.cclegacy,a=e.instantiate,i=e.Prefab},function(e){s=e.PoolBuilder,c=e.instance_base,u=e.asset,l=e.error},function(e){f=e.GTextField,p=e.AutoSizeType,h=e.UIPackage},function(e){b=e.GUIManager}],execute:function(){o._RF.push({},"04672eWqVFIKJiVK6TVkrA3","PoolMgr",void 0);e("objPoolMgr",function(e){function o(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._prefabpools=new Map,t._gobjpools=new Map,t._txtPool=null,t}t(o,e);var c=o.prototype;return c.getPrefabPool=function(){var e=n(r().mark((function e(t,o){var c,l,f;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=""+o+t,this._prefabpools.has(c)){e.next=7;break}return l=null,e.next=5,s().create(n(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l){e.next=4;break}return e.next=3,u.get(t,i,null,{bundle_s:o});case 3:l=e.sent;case 4:return e.abrupt("return",a(l));case 5:case"end":return e.stop()}}),e)})))).reset((function(e){return e.parent=null,e.active=!0,e})).clear((function(e){var t;e.forEach((function(e){e.destroy()})),null==(t=l)||t.decRef(),l=null})).initialSize(5).maxSize(50).buildAsync();case 5:f=e.sent,this._prefabpools.set(c,f);case 7:return e.abrupt("return",this._prefabpools.get(c));case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),c.getGobjPool=function(){var e=n(r().mark((function e(t,o){var a,i,c;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=""+t+o,this._gobjpools.has(a)){e.next=7;break}return i=null,e.next=5,s().create(n(r().mark((function e(){var n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i){e.next=7;break}if(i=h.getByName(t)){e.next=6;break}return e.next=5,b.loadPackage(t);case 5:i=e.sent;case 6:b.setPackageRefCount(t);case 7:return(n=i.createObject(o))||l("create gobj "+t+"/"+o+" failed,请检查资源是否存在"),e.abrupt("return",n);case 10:case"end":return e.stop()}}),e)})))).reset((function(e){return e.parent?e.removeFromParent():e.node.parent=null,e.visible=!0,e})).clear((function(e){e.forEach((function(e){e.dispose()})),b.setPackageRefCount(t,-1),i=null})).initialSize(5).maxSize(50).buildAsync();case 5:c=e.sent,this._gobjpools.set(a,c);case 7:return e.abrupt("return",this._gobjpools.get(a));case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),c.getTxtPool=function(){return this._txtPool||(this._txtPool=s().create((function(){return new f})).reset((function(e){return e.fontSize=20,e.text="",e.setPivot(.5,1,!0),e.autoSize=p.Both,e.parent?e.removeFromParent():e.node.parent=null,e.visible=!0,e})).clear((function(e){e.forEach((function(e){e.dispose()}))})).initialSize(5).maxSize(100).buildSync()),this._txtPool},c.clear=function(){this._prefabpools.forEach((function(e){e.clear(),e.destroy()})),this._prefabpools.clear(),this._gobjpools.forEach((function(e){e.clear(),e.destroy()})),this._gobjpools.clear(),this._txtPool&&(this._txtPool.clear(),this._txtPool.destroy(),this._txtPool=null)},o}(c).instance());o._RF.pop()}}}));

System.register("chunks:///_virtual/StartView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./drongo-gui.mjs","./CommonExport.ts","./fairygui.mjs","./Game_SelectGender.ts","./TaskManager.ts","./drongo-cc.mjs"],(function(e){var t,r,o,n,i,a,s,l,c,u,g,p,h,d,b,f,v,m,y,w,B,x,S,G,I,F;return{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inheritsLoose,o=e.initializerDefineProperty,n=e.assertThisInitialized,i=e.asyncToGenerator,a=e.regeneratorRuntime},function(e){s=e.cclegacy,l=e._decorator,c=e.Label,u=e.ProgressBar,g=e.Node,p=e.color,h=e.view,d=e.AudioSourceComponent,b=e.tween,f=e.Component,v=e.JsonAsset},function(e){m=e.GUIManager,y=e.AllBinder},null,function(e){w=e.UIConfig,B=e.registerFont,x=e.GRoot,S=e.UIPackage},function(e){G=e.default},function(e){I=e.taskManager},function(e){F=e.asset}],execute:function(){var j,k,z,C,M,O,P,U;s._RF.push({},"b717ey19TVBBpBqTI0xPCo1","StartView",void 0);var V=l.ccclass,A=l.property;e("default",(j=A(c),k=A(u),z=A(g),V((O=t((M=function(e){function t(){for(var t,r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return t=e.call.apply(e,[this].concat(i))||this,o(t,"label",O,n(t)),o(t,"progressBar",P,n(t)),o(t,"bg",U,n(t)),t.progressObj={value:0},t}r(t,e);var s=t.prototype;return s.onLoad=function(){w.buttonSoundVolumeScale=1,w.bringWindowToFrontOnClick=!1,B("Inter-BoldItalic"),w.defaultFont="Inter-BoldItalic",w.modalLayerColor=p(0,0,0,100),this.progressBar.progress=0,this.label.string="0%",this.progressObj.value=0},s.adaptBackgroundSize=function(){if(this.bg)try{var e=x.inst,t=e.width,r=e.height,o=h.getDesignResolutionSize(),n=h.getVisibleSize();console.log("FairyGUI适配信息:\n                FGUI根节点尺寸: "+t+" x "+r+"\n                设计分辨率: "+o.width+" x "+o.height+"\n                屏幕尺寸: "+n.width+" x "+n.height);var i=t/o.width,a=r/o.height;this.bg.setScale(i,a),console.log("背景适配完成:\n                宽度缩放: "+i.toFixed(3)+"\n                高度缩放: "+a.toFixed(3)+"\n                最终背景尺寸: "+(o.width*i).toFixed(1)+" x "+(o.height*a).toFixed(1))}catch(e){console.error("背景适配失败，回退到基础适配:",e);var s=h.getVisibleSize(),l=h.getDesignResolutionSize(),c=s.width/l.width,u=s.height/l.height;this.bg.setScale(c,u)}else console.warn("bg节点未设置，跳过背景适配")},s.playBGM=function(e,t,r){var o=S.getByName(t).getItemAssetByName(r),n=e.addComponent(d);return n.isValid&&(n.clip=o,n.volume=1,n.loop=!0,n.play()),n},s.start=function(){var e=i(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y.bindAll(),e.prev=1,this.adaptBackgroundSize(),e.next=5,I.preload();case 5:return e.prev=5,e.next=8,F.get("Game/DiceConfig",v,null);case 8:e.next=12;break;case 10:e.prev=10,e.t0=e.catch(5);case 12:return console.log("开始加载UI包..."),e.next=15,m.loadPackage("Game",(function(e,r){var o=e/r;t.updateProgress(o,"加载UI资源")}));case 15:console.log("所有资源加载完成！");try{this.playBGM(this.node,"Game","bgm"),console.log("BGM播放成功")}catch(e){console.warn("BGM播放失败:",e)}m.open(G),this.label.node.parent.active=!1,e.next=26;break;case 21:e.prev=21,e.t1=e.catch(1),console.error("资源加载失败:",e.t1),m.open(G),this.label.node.parent.active=!1;case 26:case"end":return e.stop()}}),e,this,[[1,21],[5,10]])})));return function(){return e.apply(this,arguments)}}(),s.updateProgress=function(e,t){var r=this;e<=this.progressObj.value?console.log("进度回退保护: 当前进度 "+(100*this.progressObj.value).toFixed(1)+"%, 目标进度 "+(100*e).toFixed(1)+"%"):(b(this.progressObj).stop(),b(this.progressObj).to(.3,{value:e},{onUpdate:function(){r.progressBar.progress=r.progressObj.value;var e=Math.floor(100*r.progressObj.value);r.label.string=e+"%"}}).start())},t}(f)).prototype,"label",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=t(M.prototype,"progressBar",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U=t(M.prototype,"bg",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=M))||C));s._RF.pop()}}}));

System.register("chunks:///_virtual/TaskDialogWindow.ts",["./rollupPluginModLoBabelHelpers.js","cc","./drongo-gui.mjs","./fairygui.mjs"],(function(o){var n,t,a,e,i,r;return{setters:[function(o){n=o.inheritsLoose},function(o){t=o.cclegacy,a=o.tween},function(o){e=o.GUIWindow},function(o){i=o.GLoader,r=o.LoaderFillType}],execute:function(){t._RF.push({},"d97eaajx3dMSISvLxI0Rrxl","TaskDialogWindow",void 0);o("TaskDialogWindow",function(o){function t(){for(var n,t=arguments.length,a=new Array(t),e=0;e<t;e++)a[e]=arguments[e];return(n=o.call.apply(o,[this].concat(a))||this).backgroundLoader=null,n}n(t,o);var e=t.prototype;return e.onInit=function(){this.makeFullScreen(),this.contentPane.setPivot(.5,.5),this.loadBackgroundImage()},e.loadBackgroundImage=function(){try{this.backgroundLoader=new i,this.backgroundLoader.url="ui://bpp6st2qi3nk51",this.backgroundLoader.fill=r.ScaleFree,this.backgroundLoader.setSize(this.width,this.height),this.backgroundLoader.x=0,this.backgroundLoader.y=0,this.addChildAt(this.backgroundLoader,0),console.log("成功加载任务对话框背景图片")}catch(o){console.warn("加载任务对话框背景图片失败:",o)}},e.doShowAnimation=function(){var n=this;this.contentPane.scaleX=1.2,this.contentPane.scaleY=1.2,this.contentPane.alpha=.8,a(this.contentPane).to(.5,{scaleX:1,scaleY:1,alpha:1},{easing:"backOut"}).call((function(){o.prototype.doShowAnimation.call(n)})).start()},e.doHideAnimation=function(){var n=this;a(this.contentPane).to(.3,{scaleX:.8,scaleY:.8,alpha:0},{easing:"backIn"}).call((function(){o.prototype.doHideAnimation.call(n)})).start()},e.onDestroy=function(){this.backgroundLoader&&this.backgroundLoader.parent&&(this.backgroundLoader.removeFromParent(),this.backgroundLoader.dispose(),this.backgroundLoader=null),o.prototype.onDestroy.call(this)},t}(e));t._RF.pop()}}}));

System.register("chunks:///_virtual/TaskManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./drongo-cc.mjs"],(function(n){var e,t,r,a,s,i,u,o,c,d;return{setters:[function(n){e=n.inheritsLoose,t=n.extends,r=n.createForOfIteratorHelperLoose,a=n.asyncToGenerator,s=n.regeneratorRuntime},function(n){i=n.cclegacy,u=n.JsonAsset},function(n){o=n.autoBindToWindow,c=n.instance_base,d=n.asset}],execute:function(){var l;i._RF.push({},"49149F1kmdENItKaJQMvmdX","TaskManager",void 0);var f=n("TaskManager",o(l=function(n){function i(){for(var e,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=n.call.apply(n,[this].concat(r))||this).rangedConfig=null,e.usedTaskIds=new Set,e.loadingPromise=null,e}e(i,n);var o=i.prototype;return o.ensureLoaded=function(){var n=a(s().mark((function n(){var e=this;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.rangedConfig){n.next=2;break}return n.abrupt("return");case 2:if(!this.loadingPromise){n.next=4;break}return n.abrupt("return",this.loadingPromise);case 4:return this.loadingPromise=a(s().mark((function n(){var t,r,a,i;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,d.get("Task/TaskConfig",u,null);case 3:r=n.sent,a=r.json,e.rangedConfig=a,r.decRef(),i=a.ranges.reduce((function(n,e){var t;return n+((null==(t=e.tasks)?void 0:t.length)||0)}),0),console.log("[TaskManager] 题库加载完成：范围数="+a.ranges.length+"，题目总数="+i+"，彩蛋="+((null==(t=a.eggEvents)?void 0:t.length)||0)),n.next=15;break;case 11:n.prev=11,n.t0=n.catch(0),console.error("[TaskManager] 题库加载失败:",n.t0),e.rangedConfig={ranges:[],eggEvents:[]};case 15:return n.prev=15,e.loadingPromise=null,n.finish(15);case 18:case"end":return n.stop()}}),n,null,[[0,11,15,18]])})))(),n.abrupt("return",this.loadingPromise);case 6:case"end":return n.stop()}}),n,this)})));return function(){return n.apply(this,arguments)}}(),o.preload=function(){var n=a(s().mark((function n(){return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.ensureLoaded();case 2:case"end":return n.stop()}}),n,this)})));return function(){return n.apply(this,arguments)}}(),o.isLoaded=function(){return!!this.rangedConfig},o.ensureLoadedSync=function(){if(!this.rangedConfig)throw new Error("[TaskManager] 题库未预加载，请在StartView调用 taskManager.preload()")},o.getRandomTask=function(){var n=a(s().mark((function n(){var e,r,a,i,u=this;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.ensureLoaded();case 2:if(e=this.flattenAllTasks(),0!==(r=e.filter((function(n){return!u.usedTaskIds.has(n.id)}))).length){n.next=7;break}return this.usedTaskIds.clear(),n.abrupt("return",this.getRandomTask());case 7:return a=Math.floor(Math.random()*r.length),i=t({},r[a]),this.usedTaskIds.add(i.id),n.abrupt("return",i);case 11:case"end":return n.stop()}}),n,this)})));return function(){return n.apply(this,arguments)}}(),o.getRandomTaskSync=function(){var n=this;this.ensureLoadedSync();var e=this.flattenAllTasks(),r=e.filter((function(e){return!n.usedTaskIds.has(e.id)}));0===r.length&&(this.usedTaskIds.clear(),r=e);var a=Math.floor(Math.random()*r.length),s=t({},r[a]);return this.usedTaskIds.add(s.id),s},o.getRandomTaskForPlayer=function(){var n=a(s().mark((function n(e){var t;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.getRandomTask();case 2:return(t=n.sent).player=e,console.log("为 "+e.name+" (角色ID: "+e.characterId+") 分配任务: ID="+t.id),n.abrupt("return",t);case 6:case"end":return n.stop()}}),n,this)})));return function(e){return n.apply(this,arguments)}}(),o.getRandomTaskForPlayerSync=function(n){var e=this.getRandomTaskSync();return e.player=n,e},o.getRandomTaskForPosition=function(){var n=a(s().mark((function n(e,a){var i,u,o,c,d,l,f,h,g,p,k=this;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.ensureLoaded();case 2:if(u=this.findRangeByPosition(e),o=null!=(i=null==u?void 0:u.tasks)?i:[],0===(c=o.filter((function(n){return!k.usedTaskIds.has(n.id)}))).length&&o.length>0){for(d=r(o);!(l=d()).done;)f=l.value,this.usedTaskIds.delete(f.id);c=o.slice()}if(0!==c.length){n.next=13;break}return n.next=9,this.getRandomTask();case 9:return h=n.sent,a&&(h.player=a),console.log("[TaskManager] 位置"+e+"无可用题目，使用全量兜底 ID="+h.id),n.abrupt("return",h);case 13:return g=Math.floor(Math.random()*c.length),p=t({},c[g]),this.usedTaskIds.add(p.id),a&&(p.player=a),console.log("[TaskManager] 位置"+e+" 选择范围“"+(null==u?void 0:u.name)+"”题目 ID="+p.id),n.abrupt("return",p);case 19:case"end":return n.stop()}}),n,this)})));return function(e,t){return n.apply(this,arguments)}}(),o.getRandomTaskForPositionSync=function(n,e){var a,s=this;this.ensureLoadedSync();var i=this.findRangeByPosition(n),u=null!=(a=null==i?void 0:i.tasks)?a:[],o=u.filter((function(n){return!s.usedTaskIds.has(n.id)}));if(0===o.length&&u.length>0){for(var c,d=r(u);!(c=d()).done;){var l=c.value;this.usedTaskIds.delete(l.id)}o=u.slice()}if(0===o.length){var f=this.getRandomTaskSync();return e&&(f.player=e),f}var h=Math.floor(Math.random()*o.length),g=t({},o[h]);return this.usedTaskIds.add(g.id),e&&(g.player=e),g},o.getTaskById=function(){var n=a(s().mark((function n(e){var r;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.ensureLoaded();case 2:return r=this.flattenAllTasks().find((function(n){return n.id===e})),n.abrupt("return",r?t({},r):null);case 4:case"end":return n.stop()}}),n,this)})));return function(e){return n.apply(this,arguments)}}(),o.resetUsedTasks=function(){this.usedTaskIds.clear(),console.log("任务使用记录已重置")},o.getAvailableTaskCount=function(){var n=a(s().mark((function n(){var e;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.ensureLoaded();case 2:return e=this.flattenAllTasks().length,n.abrupt("return",Math.max(0,e-this.usedTaskIds.size));case 4:case"end":return n.stop()}}),n,this)})));return function(){return n.apply(this,arguments)}}(),o.getAllTasks=function(){var n=a(s().mark((function n(){return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.ensureLoaded();case 2:return n.abrupt("return",this.flattenAllTasks().map((function(n){return t({},n)})));case 3:case"end":return n.stop()}}),n,this)})));return function(){return n.apply(this,arguments)}}(),o.getEggEvents=function(){var n=a(s().mark((function n(){var e,r;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.ensureLoaded();case 2:return n.abrupt("return",(null!=(e=null==(r=this.rangedConfig)?void 0:r.eggEvents)?e:[]).map((function(n){return t({},n)})));case 3:case"end":return n.stop()}}),n,this)})));return function(){return n.apply(this,arguments)}}(),o.findRangeByPosition=function(n){var e;return null==(e=this.rangedConfig)?void 0:e.ranges.find((function(e){return n>=e.start&&n<=e.end}))},o.flattenAllTasks=function(){if(!this.rangedConfig)return[];for(var n,e=[],t=r(this.rangedConfig.ranges);!(n=t()).done;)for(var a,s=n.value,i=r(s.tasks||[]);!(a=i()).done;){var u=a.value;e.push({id:u.id,content:u.content})}return e},i}(c))||l);n("taskManager",f.instance());i._RF.pop()}}}));

System.register("chunks:///_virtual/WinDialogWindow.ts",["./rollupPluginModLoBabelHelpers.js","cc","./drongo-gui.mjs","./fairygui.mjs"],(function(n){var t,o,i,a,e,r;return{setters:[function(n){t=n.inheritsLoose},function(n){o=n.cclegacy,i=n.tween},function(n){a=n.GUIWindow},function(n){e=n.GLoader,r=n.LoaderFillType}],execute:function(){o._RF.push({},"4defeitiJ5CQpYyT8hciTAj","WinDialogWindow",void 0);n("WinDialogWindow",function(n){function o(){for(var t,o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return(t=n.call.apply(n,[this].concat(i))||this).backgroundLoader=null,t}t(o,n);var a=o.prototype;return a.onInit=function(){this.center(),this.contentPane.y-=100,this.contentPane.setPivot(.5,.5)},a.loadBackgroundImage=function(){try{this.backgroundLoader=new e,this.backgroundLoader.url="ui://bpp6st2qi3nk51",this.backgroundLoader.fill=r.ScaleFree,this.backgroundLoader.setSize(this.width,this.height),this.backgroundLoader.x=0,this.backgroundLoader.y=0,this.addChildAt(this.backgroundLoader,0),console.log("成功加载任务对话框背景图片")}catch(n){console.warn("加载任务对话框背景图片失败:",n)}},a.doShowAnimation=function(){var t=this;this.contentPane.scaleX=1.2,this.contentPane.scaleY=1.2,this.contentPane.alpha=.8,i(this.contentPane).to(.5,{scaleX:1,scaleY:1,alpha:1},{easing:"backOut"}).call((function(){n.prototype.doShowAnimation.call(t)})).start()},a.doHideAnimation=function(){var t=this;i(this.contentPane).to(.3,{scaleX:.8,scaleY:.8,alpha:0},{easing:"backIn"}).call((function(){n.prototype.doHideAnimation.call(t)})).start()},a.onDestroy=function(){this.backgroundLoader&&this.backgroundLoader.parent&&(this.backgroundLoader.removeFromParent(),this.backgroundLoader.dispose(),this.backgroundLoader=null),n.prototype.onDestroy.call(this)},o}(a));o._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});